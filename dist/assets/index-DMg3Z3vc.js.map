{"version":3,"file":"index-DMg3Z3vc.js","sources":["../../src/constants.ts","../../src/app/state.ts","../../src/utils/formatting.ts","../../src/utils/url.ts","../../src/utils/debounce.ts","../../src/utils/input-validator.ts","../../src/events.ts","../../src/app/form-handler.ts","../../src/signature-generator/components/dark-mode.ts","../../src/signature-generator/components/logos.ts","../../src/signature-generator/components/contact-tiers.ts","../../src/signature-generator/index.ts","../../src/signature-generator/styles/classic.ts","../../src/signature-generator/styles/professional.ts","../../src/signature-generator/styles/compact.ts","../../src/signature-generator/styles/modern.ts","../../src/signature-generator/styles/creative.ts","../../src/signature-generator/styles/minimal.ts","../../src/signature-generator/components/social-links.ts","../../src/app/preview-renderer.ts","../../src/app/clipboard.ts","../../src/ui/modal.ts","../../src/ui/help-panel.ts","../../src/ui/drag-drop.ts","../../src/main.ts"],"sourcesContent":["/**\n * Application Constants\n * All constant values used throughout the application\n */\n\nimport type { FormData } from './types';\n\n/**\n * Acronyms to preserve in title case formatting\n * These will remain uppercase when smart title case is applied\n */\nexport const PRESERVED_ACRONYMS = [\n  // Job Roles\n  'VP',\n  'SVP',\n  'EVP',\n  'CEO',\n  'CTO',\n  'CFO',\n  'COO',\n  'CMO',\n  'CIO',\n  // Tech Terms\n  'iOS',\n  'API',\n  'UI',\n  'UX',\n  'IT',\n  'HR',\n  // Business Terms\n  'B2B',\n  'B2C',\n  'SaaS',\n  'SMB',\n] as const;\n\n/**\n * Words that should remain lowercase in title case (unless first word)\n */\nexport const LOWERCASE_WORDS = [\n  // Articles\n  'a',\n  'an',\n  'the',\n  // Conjunctions\n  'and',\n  'but',\n  'or',\n  'nor',\n  // Prepositions\n  'of',\n  'at',\n  'by',\n  'for',\n  'in',\n  'on',\n  'to',\n  'up',\n  'with',\n  'as',\n] as const;\n\n/**\n * Example data for preview when fields are empty\n * Shows users what their signature will look like\n */\nexport const EXAMPLE_DATA: FormData = {\n  name: 'Jasmine Frank',\n  title: 'Director of Marketing',\n  department: 'Zoho One',\n  email: 'jasmine.frank@zohocorp.com',\n  phone: '+1 (281) 330-8004',\n  linkedin: 'https://linkedin.com/in/jasminefrank',\n  twitter: 'https://x.com/jasminefrank',\n  bookings: '',\n  website: 'https://www.zoho.com',\n};\n\n/**\n * Zoho brand colors (email-compatible hex values)\n */\nexport const ZOHO_RED = '#E42527';\nexport const ZOHO_GREEN = '#089949';\nexport const ZOHO_BLUE = '#226DB4';\nexport const ZOHO_YELLOW = '#F9B21D';\n\n/**\n * Default accent color\n */\nexport const DEFAULT_ACCENT_COLOR = ZOHO_RED;\n\n/**\n * Default signature style\n */\nexport const DEFAULT_SIGNATURE_STYLE = 'classic';\n\n/**\n * Default website URL\n */\nexport const DEFAULT_WEBSITE_URL = 'https://www.zoho.com';\n\n/**\n * Zoho email domain\n */\nexport const ZOHO_EMAIL_DOMAIN = '@zohocorp.com';\n\n/**\n * Bookings URL base\n */\nexport const BOOKINGS_URL_BASE = 'https://bookings.zohocorp.com/#/';\n\n/**\n * LinkedIn URL base\n */\nexport const LINKEDIN_URL_BASE = 'https://linkedin.com/in/';\n\n/**\n * X (Twitter) URL base\n */\nexport const X_URL_BASE = 'https://x.com/';\n\n/**\n * Zoho social media URLs\n */\nexport const ZOHO_SOCIAL_URLS = {\n  twitter: 'https://x.com/Zoho',\n  linkedin: 'https://www.linkedin.com/company/zoho',\n  facebook: 'https://www.facebook.com/zoho',\n  instagram: 'https://www.instagram.com/zoho/',\n} as const;\n\n/**\n * Help content for form fields\n * Used by HelpPanelController to show expandable help panels\n */\nexport const HELP_CONTENT: Record<string, { title: string; content: string }> = {\n  'email-prefix': {\n    title: 'Email Format',\n    content:\n      'Enter your email prefix only (e.g., \"jasmine.frank\"). The @zohocorp.com domain is automatically added.',\n  },\n  phone: {\n    title: 'Phone Format',\n    content:\n      'Enter your phone number with country code. Examples: +1 (281) 330-8004 or +91 44 2344 9876',\n  },\n  'linkedin-username': {\n    title: 'LinkedIn Username',\n    content:\n      'Enter just your LinkedIn username, not the full URL. Find it in your profile URL: linkedin.com/in/YOUR-USERNAME',\n  },\n  'twitter-username': {\n    title: 'X Handle',\n    content:\n      'Enter your X handle without the @ symbol. This will link to your X profile.',\n  },\n  'bookings-id': {\n    title: 'Zoho Bookings ID',\n    content:\n      'Enter your Zoho Bookings calendar ID. Find this in Zoho Bookings under Settings > Share > Embed Code.',\n  },\n};\n\n/**\n * Social media channel display data\n */\nexport const SOCIAL_CHANNEL_DATA = {\n  twitter: { url: ZOHO_SOCIAL_URLS.twitter, text: 'X', icon: 'ùïè' },\n  linkedin: { url: ZOHO_SOCIAL_URLS.linkedin, text: 'LinkedIn', icon: 'in' },\n  facebook: { url: ZOHO_SOCIAL_URLS.facebook, text: 'Facebook', icon: 'f' },\n  instagram: { url: ZOHO_SOCIAL_URLS.instagram, text: 'Instagram', icon: 'IG' },\n} as const;\n\n/**\n * Canonical order for social channels (determines display order)\n */\nexport const CANONICAL_SOCIAL_ORDER = [\n  'linkedin',\n  'twitter',\n  'instagram',\n  'facebook',\n] as const;\n\n/**\n * localStorage keys\n */\nexport const STORAGE_KEYS = {\n  THEME: 'zoho-signature-preview-theme',\n  ACCENT_COLOR: 'signature-accent-color',\n  SOCIAL_ORDER: 'socialChannelOrder',\n  FORMAT_LOCK_PREFIX: 'format-lock-',\n  FORMAT_LOCK_NAME: 'format-lock-name',\n  FORMAT_LOCK_TITLE: 'format-lock-title',\n  FORMAT_LOCK_DEPARTMENT: 'format-lock-department',\n} as const;\n\n/**\n * Logo asset URLs (production)\n */\nexport const LOGO_URLS_PRODUCTION = {\n  light: 'https://tejasgadhia.github.io/zoho-signature-generator/assets/zoho-logo-light.png',\n  dark: 'https://tejasgadhia.github.io/zoho-signature-generator/assets/zoho-logo-dark.png',\n} as const;\n\n/**\n * Logo asset URLs (development)\n */\nexport const LOGO_URLS_DEVELOPMENT = {\n  light: './assets/zoho-logo-light.png',\n  dark: './assets/zoho-logo-dark.png',\n} as const;\n\n/**\n * Default logo height (pixels)\n */\nexport const DEFAULT_LOGO_HEIGHT = 32;\n\n/**\n * Animation durations (milliseconds)\n */\nexport const ANIMATION_DURATIONS = {\n  TOAST: 3000,\n  COPY_SUCCESS: 2000,\n  HELP_PANEL_DELAY: 200,\n  DRAG_DROP_ANIMATION: 200,\n} as const;\n\n/**\n * Keyboard shortcuts\n */\nexport const KEYBOARD_SHORTCUTS = {\n  FOCUS_FIRST_INPUT: 'k', // Cmd/Ctrl + K\n  ESCAPE: 'Escape',\n  ENTER: 'Enter',\n  SPACE: ' ',\n  ARROW_LEFT: 'ArrowLeft',\n  ARROW_RIGHT: 'ArrowRight',\n} as const;\n\n/**\n * Validation constraints\n */\nexport const VALIDATION = {\n  MIN_EMAIL_PREFIX_LENGTH: 2,\n  MIN_PHONE_DIGITS: 10,\n} as const;\n\n/**\n * Email prefix regex (lowercase letters, numbers, dots only)\n */\nexport const EMAIL_PREFIX_REGEX = /^[a-z0-9.]+$/;\n\n/**\n * Email validation regex\n */\nexport const EMAIL_REGEX = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n/**\n * Phone validation regex (10+ digits, optional + at start)\n */\nexport const PHONE_REGEX = /^\\+?\\d{10,}$/;\n","/**\n * Application State Management\n * Centralized state with immutable patterns and localStorage persistence\n */\n\nimport type { AppState, FormData, FieldToggles, SocialOptions, SignatureStyle, SocialChannel } from '../types';\nimport { STORAGE_KEYS } from '../constants';\n\n/**\n * Create a deep frozen copy of an object (immutable)\n */\nfunction deepFreeze<T extends object>(obj: T): Readonly<T> {\n  Object.freeze(obj);\n  Object.getOwnPropertyNames(obj).forEach(prop => {\n    const value = (obj as Record<string, unknown>)[prop];\n    if (value !== null && typeof value === 'object' && !Object.isFrozen(value)) {\n      deepFreeze(value as object);\n    }\n  });\n  return obj;\n}\n\n/**\n * Create default initial state\n */\nfunction createDefaultState(): AppState {\n  return {\n    formData: {\n      name: '',\n      title: '',\n      department: '',\n      email: '',\n      phone: '',\n      linkedin: '',\n      twitter: '',\n      bookings: '',\n      website: 'https://www.zoho.com'\n    },\n    fieldToggles: {\n      title: true,\n      department: true,\n      email: true,\n      phone: true,\n      linkedin: false,\n      twitter: false,\n      bookings: false,\n      website: false  // Website is locked, not toggleable\n    },\n    signatureStyle: 'classic',\n    socialOptions: {\n      enabled: true,\n      channels: ['linkedin', 'twitter', 'instagram', 'facebook'],\n      displayType: 'text'\n    },\n    isDarkModePreview: false,\n    accentColor: '#E42527',  // Default Zoho red\n    formatLockState: {\n      name: true,\n      title: true,\n      department: true\n    }\n  };\n}\n\nexport class AppStateManager {\n  private state: AppState;\n\n  constructor() {\n    this.state = createDefaultState();\n  }\n\n  /**\n   * Get the current application state (immutable copy)\n   */\n  getState(): Readonly<AppState> {\n    return deepFreeze({ ...this.state });\n  }\n\n  /**\n   * Get form data only (immutable copy)\n   */\n  getFormData(): Readonly<FormData> {\n    return deepFreeze({ ...this.state.formData });\n  }\n\n  /**\n   * Update a specific form field (immutable)\n   */\n  updateFormData(field: keyof FormData, value: string): void {\n    this.state = {\n      ...this.state,\n      formData: {\n        ...this.state.formData,\n        [field]: value\n      }\n    };\n  }\n\n  /**\n   * Update multiple form fields at once (immutable)\n   * Note: Only allows known FormData keys to prevent prototype pollution\n   */\n  updateFormDataBatch(data: Partial<FormData>): void {\n    const safeKeys: (keyof FormData)[] = [\n      'name', 'title', 'department', 'email', 'phone',\n      'linkedin', 'twitter', 'bookings', 'website'\n    ];\n\n    const updates: Partial<FormData> = {};\n    for (const key of safeKeys) {\n      if (key in data && data[key] !== undefined) {\n        updates[key] = data[key];\n      }\n    }\n\n    this.state = {\n      ...this.state,\n      formData: {\n        ...this.state.formData,\n        ...updates\n      }\n    };\n  }\n\n  /**\n   * Update field toggle state (immutable)\n   */\n  updateFieldToggle(field: keyof FieldToggles, enabled: boolean): void {\n    this.state = {\n      ...this.state,\n      fieldToggles: {\n        ...this.state.fieldToggles,\n        [field]: enabled\n      }\n    };\n  }\n\n  /**\n   * Set signature style (immutable)\n   */\n  setSignatureStyle(style: SignatureStyle): void {\n    this.state = {\n      ...this.state,\n      signatureStyle: style\n    };\n  }\n\n  /**\n   * Get current signature style\n   */\n  getSignatureStyle(): SignatureStyle {\n    return this.state.signatureStyle;\n  }\n\n  /**\n   * Update social media options (immutable)\n   */\n  setSocialOptions(options: Partial<SocialOptions>): void {\n    this.state = {\n      ...this.state,\n      socialOptions: {\n        ...this.state.socialOptions,\n        ...options\n      }\n    };\n  }\n\n  /**\n   * Set accent color (immutable)\n   */\n  setAccentColor(color: string): void {\n    this.state = {\n      ...this.state,\n      accentColor: color\n    };\n    this.saveAccentColor(color);\n  }\n\n  /**\n   * Get current accent color\n   */\n  getAccentColor(): string {\n    return this.state.accentColor;\n  }\n\n  /**\n   * Set dark mode preview state (immutable)\n   */\n  setDarkModePreview(enabled: boolean): void {\n    this.state = {\n      ...this.state,\n      isDarkModePreview: enabled\n    };\n  }\n\n  /**\n   * Toggle format lock for a field (immutable)\n   */\n  toggleFormatLock(field: 'name' | 'title' | 'department'): void {\n    const newValue = !this.state.formatLockState[field];\n    this.state = {\n      ...this.state,\n      formatLockState: {\n        ...this.state.formatLockState,\n        [field]: newValue\n      }\n    };\n    this.saveFormatLock(field, newValue);\n  }\n\n  /**\n   * Get format lock state for a field\n   */\n  getFormatLock(field: 'name' | 'title' | 'department'): boolean {\n    return this.state.formatLockState[field];\n  }\n\n  /**\n   * Set format lock state for a field (immutable)\n   */\n  setFormatLock(field: 'name' | 'title' | 'department', enabled: boolean): void {\n    this.state = {\n      ...this.state,\n      formatLockState: {\n        ...this.state.formatLockState,\n        [field]: enabled\n      }\n    };\n    this.saveFormatLock(field, enabled);\n  }\n\n  // ===== STORAGE OPERATIONS =====\n\n  /**\n   * Load state from localStorage (immutable updates)\n   */\n  loadFromStorage(): void {\n    let updates: Partial<AppState> = {};\n\n    // Load accent color\n    const savedColor = localStorage.getItem(STORAGE_KEYS.ACCENT_COLOR);\n    if (savedColor) {\n      updates.accentColor = savedColor;\n    }\n\n    // Load social channel order\n    const savedOrder = localStorage.getItem(STORAGE_KEYS.SOCIAL_ORDER);\n    if (savedOrder) {\n      try {\n        const channels = JSON.parse(savedOrder);\n        // Validate: must be array, max 4 items, only valid channel names\n        const validChannels: SocialChannel[] = ['linkedin', 'twitter', 'instagram', 'facebook'];\n        if (\n          Array.isArray(channels) &&\n          channels.length <= 4 &&\n          channels.every((ch: unknown) => typeof ch === 'string' && validChannels.includes(ch as SocialChannel))\n        ) {\n          updates.socialOptions = {\n            ...this.state.socialOptions,\n            channels: channels as SocialChannel[]\n          };\n        } else {\n          console.warn('Invalid social order format in localStorage, using defaults');\n        }\n      } catch (e) {\n        console.warn('Failed to parse saved social order:', e);\n      }\n    }\n\n    // Load format lock states\n    const formatLockUpdates: Partial<Record<'name' | 'title' | 'department', boolean>> = {};\n    (['name', 'title', 'department'] as const).forEach(field => {\n      const key = `${STORAGE_KEYS.FORMAT_LOCK_PREFIX}${field}`;\n      const saved = localStorage.getItem(key);\n      if (saved !== null) {\n        formatLockUpdates[field] = saved !== 'false';\n      }\n    });\n\n    if (Object.keys(formatLockUpdates).length > 0) {\n      updates.formatLockState = {\n        ...this.state.formatLockState,\n        ...formatLockUpdates\n      };\n    }\n\n    // Apply all updates immutably\n    if (Object.keys(updates).length > 0) {\n      this.state = {\n        ...this.state,\n        ...updates\n      };\n    }\n  }\n\n  /**\n   * Save accent color to localStorage\n   */\n  private saveAccentColor(color: string): void {\n    localStorage.setItem(STORAGE_KEYS.ACCENT_COLOR, color);\n  }\n\n  /**\n   * Save social channel order to localStorage\n   */\n  saveSocialOrder(): void {\n    localStorage.setItem(\n      STORAGE_KEYS.SOCIAL_ORDER,\n      JSON.stringify(this.state.socialOptions.channels)\n    );\n  }\n\n  /**\n   * Save format lock state to localStorage\n   */\n  private saveFormatLock(field: 'name' | 'title' | 'department', enabled: boolean): void {\n    const key = `${STORAGE_KEYS.FORMAT_LOCK_PREFIX}${field}`;\n    localStorage.setItem(key, String(enabled));\n  }\n}\n","/**\n * Text Formatting Utilities\n * Pure text transformation functions\n */\n\nimport { PRESERVED_ACRONYMS, LOWERCASE_WORDS } from '../constants';\n\n/**\n * Convert string to smart title case, preserving acronyms and handling lowercase words\n *\n * Examples:\n * - \"director of marketing\" ‚Üí \"Director of Marketing\"\n * - \"VP of iOS engineering\" ‚Üí \"VP of iOS Engineering\"\n * - \"senior b2b account manager\" ‚Üí \"Senior B2B Account Manager\"\n *\n * @param str - String to convert\n * @returns Title-cased string with preserved acronyms\n */\nexport function toSmartTitleCase(str: string): string {\n  if (!str || typeof str !== 'string') return str;\n\n  // Split into words\n  const words = str.toLowerCase().split(/\\s+/);\n\n  // Process each word\n  const result = words.map((word, index) => {\n    // Always capitalize first word\n    if (index === 0) {\n      return word.charAt(0).toUpperCase() + word.slice(1);\n    }\n\n    // Check if it's a lowercase word\n    if ((LOWERCASE_WORDS as readonly string[]).includes(word)) {\n      return word;\n    }\n\n    // Capitalize first letter\n    return word.charAt(0).toUpperCase() + word.slice(1);\n  }).join(' ');\n\n  // Restore preserved acronyms\n  let finalResult = result;\n  PRESERVED_ACRONYMS.forEach(acronym => {\n    const regex = new RegExp('\\\\b' + acronym + '\\\\b', 'gi');\n    finalResult = finalResult.replace(regex, acronym);\n  });\n\n  return finalResult;\n}\n\n/**\n * Escape HTML special characters to prevent XSS\n * @param text - Text to escape\n * @returns HTML-escaped text\n */\nexport function escapeHtml(text: string): string {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n/**\n * Sanitize phone number for tel: links\n * Removes all characters except digits and +\n * @param phone - Phone number to sanitize\n * @returns Sanitized phone number (e.g., \"+15125551234\")\n */\nexport function sanitizePhone(phone: string): string {\n  return phone.replace(/[^\\d+]/g, '');\n}\n\n/**\n * Auto-generate email prefix from full name\n *\n * Examples:\n * - \"John Smith\" ‚Üí \"john.smith\"\n * - \"Jane Doe III\" ‚Üí \"jane.doe\"\n * - \"Alice\" ‚Üí \"alice\"\n *\n * @param fullName - Full name to convert\n * @returns Email prefix (e.g., \"john.smith\")\n */\nexport function generateEmailPrefix(fullName: string): string {\n  const cleaned = fullName.trim().toLowerCase();\n  const parts = cleaned.split(/\\s+/);\n\n  if (parts.length >= 2) {\n    const first = parts[0].replace(/[^a-z]/g, '');\n    const last = parts[parts.length - 1].replace(/[^a-z]/g, '');\n    return `${first}.${last}`;\n  } else if (parts.length === 1 && parts[0]) {\n    return parts[0].replace(/[^a-z]/g, '');\n  }\n  return '';\n}\n","/**\n * URL Manipulation Utilities\n * Pure URL transformation and sanitization functions\n */\n\n/**\n * Normalize URL by adding https:// if missing\n * @param url - URL to normalize\n * @returns Normalized URL with protocol\n */\nexport function normalizeUrl(url: string): string {\n  if (!url.match(/^https?:\\/\\//)) {\n    return 'https://' + url.replace(/^\\/+/, '');\n  }\n  return url;\n}\n\n/**\n * Sanitize social media URL by extracting username/handle\n * Prevents double URL bug when users paste full URLs\n *\n * Examples:\n * - \"https://x.com/username\" ‚Üí \"username\"\n * - \"https://www.linkedin.com/in/username/\" ‚Üí \"in/username\"\n * - \"username\" ‚Üí \"username\" (unchanged)\n * - \"@username\" ‚Üí \"username\" (removes @)\n *\n * @param input - User input (username or full URL)\n * @param domain - Social media domain (e.g., 'x.com', 'linkedin.com')\n * @returns Sanitized username/path\n */\nexport function sanitizeSocialUrl(input: string, domain: string): string {\n  if (!input) return '';\n\n  try {\n    // Try to parse as URL\n    const urlObj = new URL(input.startsWith('http') ? input : 'https://' + input);\n\n    // Check if hostname matches the expected domain (with or without www.)\n    const hostname = urlObj.hostname.replace(/^www\\./, '');\n    if (hostname === domain || hostname === 'www.' + domain) {\n      // Extract the path (remove leading slash)\n      return urlObj.pathname.replace(/^\\/+/, '').replace(/\\/+$/, '');\n    }\n  } catch {\n    // Not a valid URL, treat as username/handle\n  }\n\n  // Remove any remaining URL artifacts (protocol, www., domain)\n  return input\n    .replace(/^https?:\\/\\//i, '')        // Remove protocol\n    .replace(/^www\\./i, '')               // Remove www.\n    .replace(new RegExp(`^${domain}/?`, 'i'), '') // Remove domain\n    .replace(/^\\/+/, '')                  // Remove leading slashes\n    .replace(/\\/+$/, '')                  // Remove trailing slashes\n    .replace(/^@/, '')                    // Remove @ prefix\n    .replace(/\\s+/g, '')                  // Remove all spaces\n    .toLowerCase();                       // Convert to lowercase for consistency\n}\n\n/**\n * Clean LinkedIn URL by removing tracking parameters\n * Converts https://linkedin.com/in/username?tracking=xyz to https://linkedin.com/in/username\n *\n * @param url - LinkedIn URL to clean\n * @returns Cleaned URL without tracking parameters\n */\nexport function cleanLinkedInUrl(url: string): string {\n  try {\n    const urlObj = new URL(normalizeUrl(url));\n    if (urlObj.hostname.includes('linkedin.com')) {\n      // Keep only the pathname, remove query parameters\n      return `${urlObj.protocol}//${urlObj.hostname}${urlObj.pathname}`.replace(/\\/$/, '');\n    }\n    return url;\n  } catch {\n    return url;\n  }\n}\n\n/**\n * Generate tracked zoho.com URL with UTM parameters\n * Adds utm_source, utm_medium, and utm_campaign parameters for email signature tracking\n *\n * @param emailPrefix - Email prefix to use as campaign name\n * @returns Tracked URL with UTM parameters\n */\nexport function getTrackedWebsiteURL(emailPrefix: string): string {\n  // Sanitize campaign name: only allow alphanumeric, dots, hyphens, underscores\n  // This prevents URL injection attacks\n  const sanitized = emailPrefix.trim().replace(/[^a-zA-Z0-9.\\-_]/g, '') || 'zoho-employee';\n  const baseURL = 'https://www.zoho.com';\n\n  // Build UTM parameters\n  const params = new URLSearchParams({\n    utm_source: 'email-signature',\n    utm_medium: 'signature',\n    utm_campaign: sanitized\n  });\n\n  return `${baseURL}?${params.toString()}`;\n}\n","/**\n * Debounce utility\n * Delays function execution until after a specified wait time has passed\n * since the last time it was invoked\n */\n\nexport function debounce<T extends (...args: any[]) => void>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: ReturnType<typeof setTimeout> | null = null;\n\n  return function (this: any, ...args: Parameters<T>) {\n    const context = this;\n\n    if (timeout !== null) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(() => {\n      func.apply(context, args);\n    }, wait);\n  };\n}\n","/**\n * Input Validator\n * Centralized validation layer for all form inputs\n * Validates before state updates to ensure data integrity\n */\n\nimport type { FormData, ValidationResult } from '../types';\n\n/**\n * Email validation regex - must be @zohocorp.com domain\n */\nconst ZOHOCORP_EMAIL_REGEX = /^[a-z0-9.]+@zohocorp\\.com$/i;\n\n/**\n * General email format regex\n */\nconst EMAIL_REGEX = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n/**\n * Phone validation - minimum 10 digits\n */\nconst PHONE_MIN_DIGITS = 10;\n\n/**\n * URL validation helper\n */\nfunction isValidUrl(url: string): boolean {\n  try {\n    const normalized = url.match(/^https?:\\/\\//) ? url : 'https://' + url.replace(/^\\/+/, '');\n    new URL(normalized);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Centralized input validator class\n * Provides consistent validation interface for all form fields\n */\nexport class InputValidator {\n  /**\n   * Validate any form field\n   * @param field - Field name to validate\n   * @param value - Value to validate\n   * @returns ValidationResult with status and message\n   */\n  validate(field: keyof FormData, value: string): ValidationResult {\n    const trimmedValue = value.trim();\n\n    switch (field) {\n      case 'email':\n        return this.validateEmail(trimmedValue);\n      case 'phone':\n        return this.validatePhone(trimmedValue);\n      case 'linkedin':\n        return this.validateLinkedIn(trimmedValue);\n      case 'twitter':\n        return this.validateTwitter(trimmedValue);\n      case 'bookings':\n        return this.validateBookings(trimmedValue);\n      case 'website':\n        return this.validateWebsite(trimmedValue);\n      case 'name':\n        return this.validateName(trimmedValue);\n      case 'title':\n      case 'department':\n        return this.validateText(field, trimmedValue);\n      default:\n        return this.createResult(field, trimmedValue, true, null);\n    }\n  }\n\n  /**\n   * Validate multiple fields at once\n   * @param data - Partial form data to validate\n   * @returns Array of validation results (only failed validations)\n   */\n  validateAll(data: Partial<FormData>): ValidationResult[] {\n    const results: ValidationResult[] = [];\n\n    for (const [field, value] of Object.entries(data)) {\n      if (value !== undefined) {\n        const result = this.validate(field as keyof FormData, value);\n        if (!result.isValid) {\n          results.push(result);\n        }\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Check if a value is valid for a field (simple boolean check)\n   */\n  isValid(field: keyof FormData, value: string): boolean {\n    return this.validate(field, value).isValid;\n  }\n\n  // ===== PRIVATE VALIDATORS =====\n\n  private validateEmail(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('email', value, true, null);\n    }\n\n    // Check for @zohocorp.com domain\n    if (!ZOHOCORP_EMAIL_REGEX.test(value)) {\n      // Check if it's a valid email format but wrong domain\n      if (EMAIL_REGEX.test(value)) {\n        return this.createResult('email', value, false, 'Must use @zohocorp.com domain');\n      }\n      return this.createResult('email', value, false, 'Invalid email format. Example: john.doe@zohocorp.com');\n    }\n\n    // Check email prefix rules (lowercase, no consecutive dots, etc.)\n    const prefix = value.split('@')[0];\n    if (prefix.length < 2) {\n      return this.createResult('email', value, false, 'Email prefix needs at least 2 characters');\n    }\n    if (prefix.startsWith('.') || prefix.endsWith('.') || prefix.includes('..')) {\n      return this.createResult('email', value, false, 'Dots cannot be at start, end, or consecutive');\n    }\n\n    return this.createResult('email', value, true, null);\n  }\n\n  private validatePhone(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('phone', value, true, null);\n    }\n\n    // Count digits only (ignore + and formatting)\n    const digits = value.replace(/\\D/g, '');\n    if (digits.length < PHONE_MIN_DIGITS) {\n      return this.createResult('phone', value, false, `Must have at least ${PHONE_MIN_DIGITS} digits. Example: +1 (281) 330-8004`);\n    }\n\n    return this.createResult('phone', value, true, null);\n  }\n\n  private validateLinkedIn(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('linkedin', value, true, null);\n    }\n\n    // Accept username or full URL\n    if (value.includes('linkedin.com') && !isValidUrl(value)) {\n      return this.createResult('linkedin', value, false, 'Invalid LinkedIn URL format');\n    }\n\n    return this.createResult('linkedin', value, true, null);\n  }\n\n  private validateTwitter(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('twitter', value, true, null);\n    }\n\n    // Accept username (with or without @) or full URL\n    if ((value.includes('x.com') || value.includes('twitter.com')) && !isValidUrl(value)) {\n      return this.createResult('twitter', value, false, 'Invalid X/Twitter URL format');\n    }\n\n    return this.createResult('twitter', value, true, null);\n  }\n\n  private validateBookings(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('bookings', value, true, null);\n    }\n\n    // Must be a valid URL or bookings ID\n    if (value.includes('bookings.zohocorp.com') && !isValidUrl(value)) {\n      return this.createResult('bookings', value, false, 'Invalid Bookings URL format');\n    }\n\n    return this.createResult('bookings', value, true, null);\n  }\n\n  private validateWebsite(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('website', value, true, null);\n    }\n\n    if (!isValidUrl(value)) {\n      return this.createResult('website', value, false, 'Invalid URL format');\n    }\n\n    return this.createResult('website', value, true, null);\n  }\n\n  private validateName(value: string): ValidationResult {\n    if (!value) {\n      return this.createResult('name', value, true, null);\n    }\n\n    if (value.length < 2) {\n      return this.createResult('name', value, false, 'Name must be at least 2 characters');\n    }\n\n    return this.createResult('name', value, true, null);\n  }\n\n  private validateText(field: keyof FormData, value: string): ValidationResult {\n    // Generic text validation - just checks for reasonable length\n    if (value && value.length > 100) {\n      return this.createResult(field, value, false, 'Text is too long (max 100 characters)');\n    }\n\n    return this.createResult(field, value, true, null);\n  }\n\n  /**\n   * Create a validation result object\n   */\n  private createResult(\n    field: keyof FormData,\n    value: string,\n    isValid: boolean,\n    message: string | null\n  ): ValidationResult {\n    return { field, value, isValid, message };\n  }\n}\n\n// Export singleton instance for convenience\nexport const inputValidator = new InputValidator();\n","/**\n * Event Bus\n * Centralized event dispatch for decoupled component communication\n */\n\n/**\n * Event types supported by the event bus\n */\nexport type EventType =\n  | 'preview:render'      // Request to re-render the preview\n  | 'preview:rendered'    // Preview has been rendered\n  | 'state:changed'       // Any state has changed\n  | 'form:changed'        // Form data has changed\n  | 'style:changed'       // Signature style has changed\n  | 'social:changed'      // Social options have changed\n  | 'theme:changed'       // Theme (light/dark) has changed\n  | 'color:changed';      // Accent color has changed\n\n/**\n * Event payload types\n */\nexport interface EventPayloads {\n  'preview:render': { immediate?: boolean };\n  'preview:rendered': { success: boolean };\n  'state:changed': { field?: string };\n  'form:changed': { field: string; value: string };\n  'style:changed': { style: string };\n  'social:changed': { channels?: string[]; enabled?: boolean };\n  'theme:changed': { isDark: boolean };\n  'color:changed': { color: string };\n}\n\n/**\n * Event handler function type\n */\ntype EventHandler<T extends EventType> = (payload: EventPayloads[T]) => void;\n\n/**\n * Subscription handle for unsubscribing\n */\ninterface Subscription {\n  unsubscribe: () => void;\n}\n\n/**\n * Event Bus class\n * Provides pub/sub pattern for decoupled communication\n */\nclass EventBus {\n  private handlers: Map<EventType, Set<EventHandler<EventType>>> = new Map();\n\n  /**\n   * Subscribe to an event\n   * @param event - Event type to subscribe to\n   * @param handler - Handler function to call when event is emitted\n   * @returns Subscription object with unsubscribe method\n   */\n  on<T extends EventType>(event: T, handler: EventHandler<T>): Subscription {\n    if (!this.handlers.has(event)) {\n      this.handlers.set(event, new Set());\n    }\n\n    const handlers = this.handlers.get(event)!;\n    handlers.add(handler as EventHandler<EventType>);\n\n    return {\n      unsubscribe: () => {\n        handlers.delete(handler as EventHandler<EventType>);\n      }\n    };\n  }\n\n  /**\n   * Subscribe to an event (one-time)\n   * Handler is automatically unsubscribed after first call\n   */\n  once<T extends EventType>(event: T, handler: EventHandler<T>): Subscription {\n    const wrappedHandler: EventHandler<T> = (payload) => {\n      subscription.unsubscribe();\n      handler(payload);\n    };\n\n    const subscription = this.on(event, wrappedHandler);\n    return subscription;\n  }\n\n  /**\n   * Emit an event\n   * @param event - Event type to emit\n   * @param payload - Event payload data\n   */\n  emit<T extends EventType>(event: T, payload: EventPayloads[T]): void {\n    const handlers = this.handlers.get(event);\n    if (!handlers) return;\n\n    handlers.forEach(handler => {\n      try {\n        handler(payload);\n      } catch (error) {\n        console.error(`Event handler error for \"${event}\":`, error);\n      }\n    });\n  }\n\n  /**\n   * Remove all handlers for an event\n   */\n  off(event: EventType): void {\n    this.handlers.delete(event);\n  }\n\n  /**\n   * Remove all handlers for all events\n   */\n  clear(): void {\n    this.handlers.clear();\n  }\n\n  /**\n   * Get the number of handlers for an event\n   * Useful for debugging\n   */\n  listenerCount(event: EventType): number {\n    return this.handlers.get(event)?.size || 0;\n  }\n}\n\n// Export singleton instance\nexport const eventBus = new EventBus();\n\n// Export class for testing or multiple instances\nexport { EventBus };\n","/**\n * Form Handler\n * Manages all form input events, validation, and preview updates\n */\n\nimport type { AppStateManager } from './state';\nimport type { PreviewRenderer } from './preview-renderer';\nimport type { FormData } from '../types';\nimport {\n  generateEmailPrefix,\n  toSmartTitleCase,\n  getTrackedWebsiteURL,\n  sanitizeSocialUrl,\n  debounce,\n  inputValidator\n} from '../utils';\nimport { eventBus } from '../events';\n\nexport class FormHandler {\n  private stateManager: AppStateManager;\n  private previewRenderer: PreviewRenderer;\n  private debouncedRender: () => void;\n  private userEditedEmailPrefix: boolean = false; // Track if user manually edited email prefix\n  private formatLockAbortController: AbortController | null = null; // Track format lock listeners for cleanup\n\n  constructor(stateManager: AppStateManager, previewRenderer: PreviewRenderer) {\n    this.stateManager = stateManager;\n    this.previewRenderer = previewRenderer;\n    // Debounce preview updates to reduce lag during typing (300ms delay)\n    this.debouncedRender = debounce(() => this.previewRenderer.render(), 300);\n  }\n\n  /**\n   * Initialize all form listeners\n   */\n  initialize(): void {\n    this.setupInputListeners();\n    this.setupToggleListeners();\n    this.setupStyleSelector();\n    this.setupAccentColorSelector();\n    this.setupFormatLockIcons();\n    this.setupSmartTitleCase();\n    this.setupWebsiteTracking();\n    this.setupClearButtons();\n  }\n\n  /**\n   * Setup input field listeners\n   */\n  private setupInputListeners(): void {\n    // Name input\n    const nameInput = document.getElementById('name') as HTMLInputElement;\n    if (nameInput) {\n      nameInput.addEventListener('input', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        this.handleFieldChange('name', value);\n\n        // Auto-generate email prefix from name (only if user hasn't manually edited it)\n        const emailPrefixInput = document.getElementById('email-prefix') as HTMLInputElement;\n        if (emailPrefixInput && !this.userEditedEmailPrefix) {\n          const prefix = generateEmailPrefix(value);\n          emailPrefixInput.value = prefix;\n          this.handleEmailPrefixChange(prefix);\n        }\n      });\n    }\n\n    // Email prefix input (with validation)\n    const emailPrefixInput = document.getElementById('email-prefix') as HTMLInputElement;\n    if (emailPrefixInput) {\n      emailPrefixInput.addEventListener('input', (e) => {\n        const value = (e.target as HTMLInputElement).value.toLowerCase();\n        (e.target as HTMLInputElement).value = value;  // Force lowercase\n        this.userEditedEmailPrefix = true; // Mark as manually edited\n        this.handleEmailPrefixChange(value);\n      });\n\n      emailPrefixInput.addEventListener('blur', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        this.validateField('email', `${value}@zohocorp.com`);\n      });\n    }\n\n    // LinkedIn username input\n    const linkedinUsernameInput = document.getElementById('linkedin-username') as HTMLInputElement;\n    if (linkedinUsernameInput) {\n      linkedinUsernameInput.addEventListener('input', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        // Sanitize input (handles full URLs, spaces, tracking params)\n        const cleaned = sanitizeSocialUrl(value, 'linkedin.com');\n        const fullUrl = cleaned ? `https://linkedin.com/in/${cleaned}` : '';\n        this.handleFieldChange('linkedin', fullUrl);\n      });\n\n      linkedinUsernameInput.addEventListener('blur', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        if (value) {\n          // Clean up any accidentally pasted full URLs and update input\n          const cleaned = sanitizeSocialUrl(value, 'linkedin.com');\n          (e.target as HTMLInputElement).value = cleaned;\n        }\n      });\n    }\n\n    // Twitter/X username input\n    const twitterUsernameInput = document.getElementById('twitter-username') as HTMLInputElement;\n    if (twitterUsernameInput) {\n      twitterUsernameInput.addEventListener('input', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        // Sanitize input (handles full URLs, @symbol, spaces)\n        const cleaned = sanitizeSocialUrl(value, 'x.com');\n        const fullUrl = cleaned ? `https://x.com/${cleaned}` : '';\n        this.handleFieldChange('twitter', fullUrl);\n      });\n\n      twitterUsernameInput.addEventListener('blur', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        if (value) {\n          // Clean up any accidentally pasted full URLs and update input\n          const cleaned = sanitizeSocialUrl(value, 'x.com');\n          (e.target as HTMLInputElement).value = cleaned;\n        }\n      });\n    }\n\n    // Bookings ID input\n    const bookingsIdInput = document.getElementById('bookings-id') as HTMLInputElement;\n    if (bookingsIdInput) {\n      bookingsIdInput.addEventListener('input', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        const fullUrl = value ? `https://bookings.zohocorp.com/#/${value}` : '';\n        this.handleFieldChange('bookings', fullUrl);\n      });\n    }\n\n    // Standard text inputs (title, department, phone)\n    ['title', 'department', 'phone'].forEach(fieldId => {\n      const input = document.getElementById(fieldId) as HTMLInputElement;\n      if (!input) return;\n\n      input.addEventListener('input', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        this.handleFieldChange(fieldId as keyof FormData, value);\n      });\n\n      input.addEventListener('blur', (e) => {\n        const value = (e.target as HTMLInputElement).value;\n        this.validateField(fieldId as keyof FormData, value);\n      });\n    });\n  }\n\n  /**\n   * Handle email prefix change\n   */\n  private handleEmailPrefixChange(prefix: string): void {\n    // Strip @zohocorp.com if user typed it (prevent double domain)\n    const cleanPrefix = prefix.replace(/@zohocorp\\.com$/i, '').trim();\n    const fullEmail = cleanPrefix ? `${cleanPrefix}@zohocorp.com` : '';\n    this.handleFieldChange('email', fullEmail);\n  }\n\n  /**\n   * Handle field value change\n   */\n  private handleFieldChange(field: keyof FormData, value: string): void {\n    this.stateManager.updateFormData(field, value);\n    eventBus.emit('form:changed', { field, value });\n    this.debouncedRender();\n  }\n\n  /**\n   * Validate a field and show/hide error messages\n   * Uses centralized InputValidator for consistent validation\n   */\n  private validateField(field: keyof FormData, value: string): boolean {\n    // Map field names to actual input IDs (handles special cases like email-prefix)\n    const inputIdMap: Record<string, string> = {\n      'email': 'email-prefix',\n      'linkedin': 'linkedin-username',\n      'twitter': 'twitter-username',\n      'bookings': 'bookings-id',\n      'phone': 'phone'\n    };\n\n    const inputId = inputIdMap[field] || field;\n    const inputElement = document.getElementById(inputId);\n    const inputGroup = inputElement?.closest('.input-group');\n    const validationIcon = inputGroup?.querySelector('.validation-icon') as HTMLElement;\n\n    if (!validationIcon) return true;\n\n    // Use centralized validator\n    const result = inputValidator.validate(field, value);\n    let iconContent = '';\n\n    // Only show validation for fields that have visual feedback (email, phone)\n    if (field === 'email' || field === 'phone') {\n      if (value && !result.isValid) {\n        iconContent = '‚úó';\n      } else if (value) {\n        iconContent = '‚úì';\n      }\n    }\n\n    // Update validation icon\n    if (iconContent) {\n      validationIcon.textContent = iconContent;\n      validationIcon.className = result.isValid ? 'validation-icon valid' : 'validation-icon invalid';\n      validationIcon.style.display = 'flex';\n      validationIcon.setAttribute('aria-label', result.message ? `‚úó ${result.message}` : 'Valid');\n    } else {\n      validationIcon.style.display = 'none';\n    }\n\n    return result.isValid;\n  }\n\n  /**\n   * Setup toggle switches for optional fields\n   */\n  private setupToggleListeners(): void {\n    // Note: Toggles are <div> elements with data-field, not <input> elements\n    const toggles = document.querySelectorAll<HTMLElement>('.toggle-switch[data-field]:not(.social-toggle)');\n\n    toggles.forEach((toggle) => {\n      const field = toggle.dataset.field;\n      if (!field) return;\n\n      toggle.addEventListener('click', () => {\n        // Toggle active state\n        const isActive = toggle.classList.contains('active');\n        const enabled = !isActive;\n\n        // Update visual state\n        toggle.classList.toggle('active');\n        toggle.setAttribute('aria-checked', String(enabled));\n\n        const fieldToggles = this.stateManager.getState().fieldToggles;\n\n        // Only update toggle if it's a valid toggle field\n        if (field in fieldToggles) {\n          this.stateManager.updateFieldToggle(field as any, enabled);\n\n          // Map field name to input ID (handle special cases)\n          let inputId = field;\n          if (field === 'email') {\n            inputId = 'email-prefix';\n          } else if (field === 'linkedin') {\n            inputId = 'linkedin-username';\n          } else if (field === 'twitter') {\n            inputId = 'twitter-username';\n          } else if (field === 'bookings') {\n            inputId = 'bookings-id';\n          }\n\n          // Disable/enable the corresponding input\n          const input = document.getElementById(inputId) as HTMLInputElement;\n          if (input) {\n            input.disabled = !enabled;\n            if (!enabled) {\n              input.value = '';\n              this.handleFieldChange(field as keyof FormData, '');\n            }\n          }\n\n          this.previewRenderer.render();\n        }\n      });\n    });\n  }\n\n  /**\n   * Setup signature style selector\n   */\n  private setupStyleSelector(): void {\n    const styleRadios = document.querySelectorAll<HTMLInputElement>('input[name=\"signatureStyle\"]');\n\n    styleRadios.forEach((radio) => {\n      radio.addEventListener('change', (e) => {\n        const target = e.target as HTMLInputElement;\n        if (target.checked) {\n          const style = target.value as any;\n          this.stateManager.setSignatureStyle(style);\n          eventBus.emit('style:changed', { style });\n          // Use immediate render for style changes (not debounced)\n          this.previewRenderer.render();\n        }\n      });\n\n      // Also listen on the parent label for clicks\n      const label = radio.closest('.style-option') as HTMLElement;\n      if (label) {\n        label.addEventListener('click', () => {\n          if (!radio.checked) {\n            radio.checked = true;\n            const style = radio.value as any;\n            this.stateManager.setSignatureStyle(style);\n            this.previewRenderer.render();\n          }\n        });\n      }\n    });\n  }\n\n  /**\n   * Setup accent color selector\n   */\n  private setupAccentColorSelector(): void {\n    const colorButtons = document.querySelectorAll<HTMLButtonElement>('.color-btn');\n\n    colorButtons.forEach((button) => {\n      button.addEventListener('click', () => {\n        const color = button.dataset.color;\n        if (!color) return;\n\n        // Update selected state (CSS uses 'selected' class for checkmark and border)\n        colorButtons.forEach(btn => btn.classList.remove('selected'));\n        button.classList.add('selected');\n\n        // Update state and preview\n        this.stateManager.setAccentColor(color);\n        eventBus.emit('color:changed', { color });\n        this.previewRenderer.render();\n      });\n    });\n  }\n\n  /**\n   * Setup format lock icons (title case auto-formatting)\n   */\n  private setupFormatLockIcons(): void {\n    // Abort any existing listeners before adding new ones (prevents leak on re-init)\n    if (this.formatLockAbortController) {\n      this.formatLockAbortController.abort();\n    }\n    this.formatLockAbortController = new AbortController();\n    const { signal } = this.formatLockAbortController;\n\n    document.querySelectorAll('.format-lock-icon').forEach(icon => {\n      const fieldId = (icon as HTMLElement).dataset.field as 'name' | 'title' | 'department';\n\n      // Set initial state\n      const isLocked = this.stateManager.getFormatLock(fieldId);\n      if (!isLocked) {\n        icon.classList.remove('locked');\n        icon.setAttribute('title', 'Title Case OFF - click to enable auto-capitalization');\n      } else {\n        icon.setAttribute('title', 'Title Case ON - formats as you type');\n      }\n\n      // Toggle on click (with AbortController for cleanup)\n      icon.addEventListener('click', () => {\n        this.stateManager.toggleFormatLock(fieldId);\n        const newState = this.stateManager.getFormatLock(fieldId);\n\n        icon.classList.toggle('locked');\n        icon.setAttribute('title', newState\n          ? 'Title Case ON - formats as you type'\n          : 'Title Case OFF - click to enable auto-capitalization'\n        );\n      }, { signal });\n    });\n  }\n\n  /**\n   * Setup smart title case formatting\n   */\n  private setupSmartTitleCase(): void {\n    ['name', 'title', 'department'].forEach(fieldId => {\n      const input = document.getElementById(fieldId) as HTMLInputElement;\n      if (!input) return;\n\n      const applyFormatting = (preserveCursor = false) => {\n        const isLocked = this.stateManager.getFormatLock(fieldId as 'name' | 'title' | 'department');\n\n        if (isLocked && input.value.trim()) {\n          // Store cursor position\n          const cursorPos = preserveCursor ? input.selectionStart : null;\n\n          input.value = toSmartTitleCase(input.value);\n          this.handleFieldChange(fieldId as keyof FormData, input.value);\n\n          // Restore cursor position\n          if (preserveCursor && cursorPos !== null) {\n            input.setSelectionRange(cursorPos, cursorPos);\n          }\n        }\n      };\n\n      // Apply on input for instant feedback\n      input.addEventListener('input', () => applyFormatting(true));\n\n      // Apply on blur for final cleanup\n      input.addEventListener('blur', () => applyFormatting(false));\n\n      // Apply on paste\n      input.addEventListener('paste', () => {\n        setTimeout(() => applyFormatting(false), 10);\n      });\n    });\n  }\n\n  /**\n   * Setup website URL tracking (UTM parameters)\n   */\n  private setupWebsiteTracking(): void {\n    const emailPrefixInput = document.getElementById('email-prefix') as HTMLInputElement;\n\n    if (emailPrefixInput) {\n      emailPrefixInput.addEventListener('input', () => {\n        const prefix = emailPrefixInput.value.trim();\n        const trackedUrl = getTrackedWebsiteURL(prefix);\n        this.stateManager.updateFormData('website', trackedUrl);\n        this.debouncedRender();\n      });\n    }\n\n    // Set initial tracked URL\n    const initialPrefix = emailPrefixInput?.value.trim() || 'zoho-employee';\n    const initialTrackedUrl = getTrackedWebsiteURL(initialPrefix);\n    this.stateManager.updateFormData('website', initialTrackedUrl);\n  }\n\n  /**\n   * Setup clear buttons for inputs\n   */\n  private setupClearButtons(): void {\n    const clearButtons = document.querySelectorAll<HTMLButtonElement>('.clear-btn');\n\n    clearButtons.forEach((button) => {\n      button.addEventListener('click', (e) => {\n        e.preventDefault();\n        const fieldId = button.dataset.field as keyof FormData;\n        if (!fieldId) return;\n\n        const input = document.getElementById(fieldId) as HTMLInputElement;\n        if (input) {\n          input.value = '';\n          this.handleFieldChange(fieldId, '');\n        }\n      });\n    });\n  }\n}\n","/**\n * Dark Mode Component\n * Generates CSS style blocks for dark mode email signatures\n */\n\n/**\n * Generate dark mode CSS style block\n * @param isPreview - If true, only use .dark-mode class (ignore system preference)\n * @returns <style> block with dark mode overrides\n */\nexport function getDarkModeStyles(isPreview: boolean = false): string {\n  if (isPreview) {\n    // Preview mode: ONLY respond to .dark-mode class, ignore system preference\n    return `\n<style>\n  /* Dark mode styles - ONLY for preview toggle (ignores system preference) */\n  .dark-mode .sig-name { color: #FFFFFF !important; }\n  .dark-mode .sig-title { color: #E0E0E0 !important; }\n  /* Note: .sig-link uses inline accent color - no override needed */\n  .dark-mode .sig-separator { color: #666666 !important; }\n  .dark-mode .sig-logo-light { display: none !important; }\n  .dark-mode .sig-logo-dark { display: inline-block !important; }\n\n  /* Default: hide dark logo */\n  .sig-logo-dark { display: none; }\n</style>`.trim();\n  } else {\n    // Copy mode: Include media query for email clients\n    return `\n<style>\n  /* Dark mode styles - applies when email client uses dark mode */\n  @media (prefers-color-scheme: dark) {\n    /* Text colors - High contrast for WCAG AA compliance */\n    .sig-name { color: #FFFFFF !important; }\n    .sig-title { color: #E0E0E0 !important; }\n    /* Note: .sig-link uses inline accent color - no override needed */\n    .sig-separator { color: #666666 !important; }\n\n    /* Logo switching - hide light, show dark */\n    .sig-logo-light { display: none !important; }\n    .sig-logo-dark { display: inline-block !important; }\n  }\n\n  /* Also apply dark mode when container has .dark-mode class (for preview toggle) */\n  .dark-mode .sig-name { color: #FFFFFF !important; }\n  .dark-mode .sig-title { color: #E0E0E0 !important; }\n  /* Note: .sig-link uses inline accent color - no override needed */\n  .dark-mode .sig-separator { color: #666666 !important; }\n  .dark-mode .sig-logo-light { display: none !important; }\n  .dark-mode .sig-logo-dark { display: inline-block !important; }\n\n  /* Default: hide dark logo */\n  .sig-logo-dark { display: none; }\n</style>`.trim();\n  }\n}\n","/**\n * Logo Components\n * Handles dual logo generation (light/dark modes) for email signatures\n */\n\n// Production base URL for email signatures (must be absolute for email clients)\nconst PRODUCTION_ASSETS_URL = 'https://tejasgadhia.github.io/zoho-signature-generator/assets';\n\n/**\n * Get logo URLs for both light and dark modes\n * Uses relative paths for local development and absolute URLs for production\n */\nexport function getLogoUrls(): { light: string; dark: string } {\n  // Use Vite's env check instead of hostname - cleaner and tree-shakeable\n  const baseUrl = import.meta.env.PROD ? PRODUCTION_ASSETS_URL : './assets';\n\n  return {\n    light: `${baseUrl}/zoho-logo-light.png`,\n    dark: `${baseUrl}/zoho-logo-dark.png`,\n  };\n}\n\n/**\n * Generate dual logo HTML (light + dark versions)\n * Both logos included, CSS media query controls visibility\n */\nexport function generateDualLogos(websiteUrl: string, height: number = 32): string {\n  const logos = getLogoUrls();\n  return `\n<a href=\"${websiteUrl}\" rel=\"noopener noreferrer\" style=\"text-decoration: none; display: inline-block;\">\n    <img src=\"${logos.light}\"\n         alt=\"Zoho\"\n         class=\"sig-logo-light\"\n         style=\"height: ${height}px; display: block; border: 0;\"\n         height=\"${height}\">\n    <img src=\"${logos.dark}\"\n         alt=\"Zoho\"\n         class=\"sig-logo-dark\"\n         style=\"height: ${height}px; display: none; border: 0;\"\n         height=\"${height}\">\n</a>`.trim();\n}\n","/**\n * Contact Tiers Component\n * Builds tiered contact information (Tier 1: Primary, Tier 2: Personal)\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml, sanitizePhone, sanitizeSocialUrl } from '../../utils';\n\n/**\n * Build Tier 1 links: Primary Contact (Phone + Email)\n */\nexport function buildTier1Links(\n  data: FormData,\n  accentColor: string\n): string {\n  const tier1Links: string[] = [];\n\n  if (data.phone) {\n    tier1Links.push(\n      `<a href=\"tel:${sanitizePhone(data.phone)}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none;\">${escapeHtml(data.phone)}</a>`\n    );\n  }\n\n  if (data.email) {\n    tier1Links.push(\n      `<a href=\"mailto:${escapeHtml(data.email)}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none;\">${escapeHtml(data.email)}</a>`\n    );\n  }\n\n  return tier1Links.length > 0\n    ? tier1Links.join(` <span class=\"sig-separator\" style=\"color: ${accentColor};\">‚Ä¢</span> `)\n    : '';\n}\n\n/**\n * Build Tier 2 links: Personal Connections (LinkedIn + X + Bookings)\n */\nexport function buildTier2Links(\n  data: FormData,\n  accentColor: string\n): string {\n  const tier2Links: string[] = [];\n\n  if (data.linkedin) {\n    const linkedinPath = sanitizeSocialUrl(data.linkedin, 'linkedin.com');\n    const linkedinUrl = `https://www.linkedin.com/${linkedinPath}`;\n    tier2Links.push(\n      `<a href=\"${linkedinUrl}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none;\">LinkedIn</a>`\n    );\n  }\n\n  if (data.twitter) {\n    const xHandle = sanitizeSocialUrl(data.twitter, 'x.com').replace('@', '');\n    tier2Links.push(\n      `<a href=\"https://x.com/${xHandle}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none;\">X</a>`\n    );\n  }\n\n  if (data.bookings) {\n    tier2Links.push(\n      `<a href=\"${escapeHtml(data.bookings)}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none;\">Book a Meeting</a>`\n    );\n  }\n\n  return tier2Links.length > 0\n    ? tier2Links.join(` <span class=\"sig-separator\" style=\"color: ${accentColor};\">‚Ä¢</span> `)\n    : '';\n}\n","/**\n * Signature Generator - Main Entry Point\n * Orchestrates signature generation across all styles and components\n * Includes error boundaries for resilient signature generation\n */\n\nimport type { FormData, SignatureStyle, SocialOptions } from '../types';\nimport { generateSocialLinks } from './components/social-links';\nimport { escapeHtml } from '../utils/formatting';\n\n// Import all style generators\nimport * as ClassicStyle from './styles/classic';\nimport * as ProfessionalStyle from './styles/professional';\nimport * as CompactStyle from './styles/compact';\nimport * as ModernStyle from './styles/modern';\nimport * as CreativeStyle from './styles/creative';\nimport * as MinimalStyle from './styles/minimal';\n\n/**\n * Custom error class for signature generation failures\n */\nexport class SignatureGenerationError extends Error {\n  constructor(\n    message: string,\n    public readonly style: SignatureStyle,\n    public readonly cause?: unknown\n  ) {\n    super(message);\n    this.name = 'SignatureGenerationError';\n  }\n}\n\n/**\n * Style generator function type\n */\ntype StyleGenerator = (\n  data: FormData,\n  websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n) => string;\n\n/**\n * Map of style names to generator functions\n */\nconst STYLE_GENERATORS: Record<SignatureStyle, StyleGenerator> = {\n  classic: ClassicStyle.generate,\n  professional: ProfessionalStyle.generate,\n  compact: CompactStyle.generate,\n  modern: ModernStyle.generate,\n  creative: CreativeStyle.generate,\n  minimal: MinimalStyle.generate\n};\n\n/**\n * Generate a fallback signature when style generation fails\n * Uses minimal HTML that works in all email clients\n */\nfunction generateFallbackSignature(data: FormData, accentColor: string): string {\n  const name = escapeHtml(data.name || '');\n  const title = escapeHtml(data.title || '');\n  const department = escapeHtml(data.department || '');\n  const email = escapeHtml(data.email || '');\n  const phone = escapeHtml(data.phone || '');\n\n  return `\n    <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 14px; color: #333333;\">\n      <tr>\n        <td style=\"padding-bottom: 8px;\">\n          <strong style=\"font-size: 16px; color: ${accentColor};\">${name}</strong>\n        </td>\n      </tr>\n      ${title ? `<tr><td>${title}${department ? ` | ${department}` : ''}</td></tr>` : ''}\n      ${email ? `<tr><td><a href=\"mailto:${email}\" style=\"color: ${accentColor}; text-decoration: none;\">${email}</a></td></tr>` : ''}\n      ${phone ? `<tr><td>${phone}</td></tr>` : ''}\n    </table>\n  `.trim();\n}\n\n/**\n * Main SignatureGenerator class\n * Provides static methods for generating email signatures with error boundaries\n */\nexport class SignatureGenerator {\n  /**\n   * Generate HTML signature from form data\n   * Includes error boundary - falls back to simple signature if style fails\n   */\n  static generate(\n    data: FormData,\n    style: SignatureStyle = 'classic',\n    socialOptions: SocialOptions = { enabled: false, channels: [], displayType: 'text' },\n    accentColor: string = '#E42527',\n    isPreview: boolean = false\n  ): string {\n    const websiteUrl = data.website || 'https://www.zoho.com';\n\n    // Build Zoho social handles if requested (with error boundary)\n    let zohoSocialHtml = '';\n    try {\n      if (socialOptions.enabled && socialOptions.channels && socialOptions.channels.length > 0) {\n        zohoSocialHtml = generateSocialLinks(\n          socialOptions.channels,\n          socialOptions.displayType,\n          accentColor\n        );\n      }\n    } catch (error) {\n      console.warn('Failed to generate social links, continuing without them:', error);\n      zohoSocialHtml = '';\n    }\n\n    // Get the generator for the requested style\n    const generator = STYLE_GENERATORS[style];\n    if (!generator) {\n      console.warn(`Unknown style \"${style}\", falling back to classic`);\n      return this.generateWithFallback(\n        STYLE_GENERATORS.classic,\n        data,\n        websiteUrl,\n        zohoSocialHtml,\n        accentColor,\n        isPreview,\n        'classic'\n      );\n    }\n\n    return this.generateWithFallback(\n      generator,\n      data,\n      websiteUrl,\n      zohoSocialHtml,\n      accentColor,\n      isPreview,\n      style\n    );\n  }\n\n  /**\n   * Generate signature with fallback on error\n   */\n  private static generateWithFallback(\n    generator: StyleGenerator,\n    data: FormData,\n    websiteUrl: string,\n    zohoSocialHtml: string,\n    accentColor: string,\n    isPreview: boolean,\n    styleName: SignatureStyle\n  ): string {\n    try {\n      return generator(data, websiteUrl, zohoSocialHtml, accentColor, isPreview);\n    } catch (error) {\n      console.error(`Style \"${styleName}\" failed to generate:`, error);\n\n      // Try classic style as secondary fallback (unless we're already classic)\n      if (styleName !== 'classic') {\n        try {\n          console.warn(`Falling back to classic style`);\n          return STYLE_GENERATORS.classic(data, websiteUrl, zohoSocialHtml, accentColor, isPreview);\n        } catch (classicError) {\n          console.error('Classic style also failed:', classicError);\n        }\n      }\n\n      // Ultimate fallback: minimal inline signature\n      console.warn('Using emergency fallback signature');\n      return generateFallbackSignature(data, accentColor);\n    }\n  }\n\n  /**\n   * Generate preview HTML\n   * Note: Preview container background is controlled by CSS (.preview-container.dark-mode)\n   * Signature itself should maintain email-compatible colors (works on both light/dark)\n   */\n  static generatePreview(\n    data: FormData,\n    style: SignatureStyle = 'classic',\n    socialOptions: SocialOptions = { enabled: false, channels: [], displayType: 'text' },\n    accentColor: string = '#E42527'\n  ): string {\n    if (!data.name) {\n      return `\n        <div style=\"text-align: center; padding: 40px 20px; color: #999999;\">\n          <p style=\"font-size: 16px; margin: 0;\">Fill in your name to preview the signature</p>\n        </div>\n      `;\n    }\n\n    // Pass isPreview=true to exclude media query dark mode\n    return this.generate(data, style, socialOptions, accentColor, true);\n  }\n\n  /**\n   * Validate that a style can be generated successfully\n   * Useful for testing or pre-validation\n   */\n  static validateStyle(style: SignatureStyle): boolean {\n    return style in STYLE_GENERATORS;\n  }\n}\n","/**\n * Classic Signature Style\n * Logo-top stacked layout, 3-tier content hierarchy\n * Best for everyone - universal format\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml } from '../../utils';\nimport { getDarkModeStyles } from '../components/dark-mode';\nimport { generateDualLogos } from '../components/logos';\nimport { buildTier1Links, buildTier2Links } from '../components/contact-tiers';\n\nexport function generate(\n  data: FormData,\n  websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n): string {\n  // Build title line\n  const titleParts: string[] = [];\n  if (data.title) titleParts.push(escapeHtml(data.title));\n  if (data.department) titleParts.push(escapeHtml(data.department));\n  const titleLine = titleParts.join(' | ');\n\n  // Tier 1: Primary Contact (Phone + Email)\n  const tier1Html = buildTier1Links(data, accentColor);\n\n  // Tier 2: Personal Connections (LinkedIn + X + Bookings)\n  const tier2Html = buildTier2Links(data, accentColor);\n\n  return (\n    getDarkModeStyles(isPreview) +\n    `\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;\">\n    <tr>\n        <td style=\"padding-bottom: 10px;\">\n            ${generateDualLogos(websiteUrl, 34)}\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class=\"sig-name\" style=\"font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;\">\n                ${escapeHtml(data.name)}\n            </div>\n            ${\n              titleLine\n                ? `\n            <div class=\"sig-title\" style=\"font-size: 13px; color: #666666; margin-bottom: 7px;\">\n                ${titleLine}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier1Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 4px;\">\n                ${tier1Html}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier2Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 2px;\">\n                ${tier2Html}\n            </div>\n            `\n                : ''\n            }\n            ${zohoSocialHtml}\n        </td>\n    </tr>\n</table>`.trim()\n  );\n}\n","/**\n * Professional Signature Style\n * Two-column layout, no accent bar\n * Best for Sales, Account Management, client-facing roles\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml } from '../../utils';\nimport { getDarkModeStyles } from '../components/dark-mode';\nimport { generateDualLogos } from '../components/logos';\nimport { buildTier1Links, buildTier2Links } from '../components/contact-tiers';\n\nexport function generate(\n  data: FormData,\n  websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n): string {\n  // Build title line\n  const titleParts: string[] = [];\n  if (data.title) titleParts.push(escapeHtml(data.title));\n  if (data.department) titleParts.push(escapeHtml(data.department));\n  const titleLine = titleParts.join(' | ');\n\n  // Tier 1: Primary Contact (Phone + Email)\n  const tier1Html = buildTier1Links(data, accentColor);\n\n  // Tier 2: Personal Connections (LinkedIn + X + Bookings)\n  const tier2Html = buildTier2Links(data, accentColor);\n\n  return (\n    getDarkModeStyles(isPreview) +\n    `\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;\">\n    <tr>\n        <td style=\"padding-right: 14px; vertical-align: top; width: 75px;\">\n            ${generateDualLogos(websiteUrl, 38)}\n        </td>\n        <td style=\"vertical-align: top;\">\n            <div class=\"sig-name\" style=\"font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;\">\n                ${escapeHtml(data.name)}\n            </div>\n            ${\n              titleLine\n                ? `\n            <div class=\"sig-title\" style=\"font-size: 13px; color: #666666; margin-bottom: 7px;\">\n                ${titleLine}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier1Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 4px;\">\n                ${tier1Html}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier2Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 2px;\">\n                ${tier2Html}\n            </div>\n            `\n                : ''\n            }\n            ${zohoSocialHtml}\n        </td>\n    </tr>\n</table>`.trim()\n  );\n}\n","/**\n * Compact Signature Style\n * Space-efficient single-line layout\n * Best for mobile-heavy users and quick responders\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml } from '../../utils';\nimport { getDarkModeStyles } from '../components/dark-mode';\nimport { generateDualLogos } from '../components/logos';\nimport { buildTier1Links, buildTier2Links } from '../components/contact-tiers';\n\nexport function generate(\n  data: FormData,\n  websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n): string {\n  // Build title line (inline with name)\n  const titleParts: string[] = [];\n  if (data.title) titleParts.push(escapeHtml(data.title));\n  if (data.department) titleParts.push(escapeHtml(data.department));\n  const titleLine = titleParts.join(' | ');\n\n  // Tier 1: Primary Contact (Phone + Email)\n  const tier1Html = buildTier1Links(data, accentColor);\n\n  // Tier 2: Personal Connections (LinkedIn + X + Bookings)\n  const tier2Html = buildTier2Links(data, accentColor);\n\n  return (\n    getDarkModeStyles(isPreview) +\n    `\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 12px; line-height: 1.6; color: #333333;\">\n    <tr>\n        <td style=\"padding-right: 10px; vertical-align: middle;\">\n            ${generateDualLogos(websiteUrl, 26)}\n        </td>\n        <td style=\"vertical-align: middle;\">\n            <div style=\"margin-bottom: 3px;\">\n                <span class=\"sig-name\" style=\"font-weight: bold; color: #333333;\">${escapeHtml(data.name)}</span>\n                ${titleLine ? `<span class=\"sig-separator\" style=\"color: ${accentColor};\"> ‚Ä¢ </span><span class=\"sig-title\" style=\"color: #666666;\">${titleLine}</span>` : ''}\n            </div>\n            ${\n              tier1Html\n                ? `\n            <div style=\"margin-bottom: 3px;\">\n                ${tier1Html}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier2Html\n                ? `\n            <div style=\"margin-bottom: 3px;\">\n                ${tier2Html}\n            </div>\n            `\n                : ''\n            }\n            ${zohoSocialHtml}\n        </td>\n    </tr>\n</table>`.trim()\n  );\n}\n","/**\n * Modern Signature Style\n * Two-column with vertical accent bar separator\n * Best for Product, Engineering Leadership, tech-savvy professionals\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml } from '../../utils';\nimport { getDarkModeStyles } from '../components/dark-mode';\nimport { generateDualLogos } from '../components/logos';\nimport { buildTier1Links, buildTier2Links } from '../components/contact-tiers';\n\nexport function generate(\n  data: FormData,\n  websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n): string {\n  // Build title line\n  const titleParts: string[] = [];\n  if (data.title) titleParts.push(escapeHtml(data.title));\n  if (data.department) titleParts.push(escapeHtml(data.department));\n  const titleLine = titleParts.join(' | ');\n\n  // Tier 1: Primary Contact (Phone + Email)\n  const tier1Html = buildTier1Links(data, accentColor);\n\n  // Tier 2: Personal Connections (LinkedIn + X + Bookings)\n  const tier2Html = buildTier2Links(data, accentColor);\n\n  return (\n    getDarkModeStyles(isPreview) +\n    `\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;\">\n    <tr>\n        <td style=\"padding-right: 14px; vertical-align: top; width: 75px;\">\n            ${generateDualLogos(websiteUrl, 38)}\n        </td>\n        <td style=\"width: 2px; background: ${accentColor}; opacity: 0.3;\">&nbsp;</td>\n        <td style=\"padding-left: 14px; vertical-align: top;\">\n            <div class=\"sig-name\" style=\"font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;\">\n                ${escapeHtml(data.name)}\n            </div>\n            ${\n              titleLine\n                ? `\n            <div class=\"sig-title\" style=\"font-size: 13px; color: #666666; margin-bottom: 7px;\">\n                ${titleLine}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier1Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 4px;\">\n                ${tier1Html}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier2Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 2px;\">\n                ${tier2Html}\n            </div>\n            `\n                : ''\n            }\n            ${zohoSocialHtml}\n        </td>\n    </tr>\n</table>`.trim()\n  );\n}\n","/**\n * Creative Signature Style\n * Thick left accent bar with logo stacked above name\n * Best for Marketing, Design, Events teams\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml } from '../../utils';\nimport { getDarkModeStyles } from '../components/dark-mode';\nimport { generateDualLogos } from '../components/logos';\nimport { buildTier1Links, buildTier2Links } from '../components/contact-tiers';\n\nexport function generate(\n  data: FormData,\n  websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n): string {\n  // Build title line\n  const titleParts: string[] = [];\n  if (data.title) titleParts.push(escapeHtml(data.title));\n  if (data.department) titleParts.push(escapeHtml(data.department));\n  const titleLine = titleParts.join(' | ');\n\n  // Tier 1: Primary Contact (Phone + Email)\n  const tier1Html = buildTier1Links(data, accentColor);\n\n  // Tier 2: Personal Connections (LinkedIn + X + Bookings)\n  const tier2Html = buildTier2Links(data, accentColor);\n\n  return (\n    getDarkModeStyles(isPreview) +\n    `\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;\">\n    <tr>\n        <td style=\"width: 4px; background: ${accentColor};\">&nbsp;</td>\n        <td style=\"padding-left: 14px; vertical-align: top;\">\n            <div style=\"margin-bottom: 10px;\">\n                ${generateDualLogos(websiteUrl, 32)}\n            </div>\n            <div class=\"sig-name\" style=\"font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;\">\n                ${escapeHtml(data.name)}\n            </div>\n            ${\n              titleLine\n                ? `\n            <div class=\"sig-title\" style=\"font-size: 13px; color: #666666; margin-bottom: 7px;\">\n                ${titleLine}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier1Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 4px;\">\n                ${tier1Html}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier2Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 2px;\">\n                ${tier2Html}\n            </div>\n            `\n                : ''\n            }\n            ${zohoSocialHtml}\n        </td>\n    </tr>\n</table>`.trim()\n  );\n}\n","/**\n * Minimal Signature Style\n * Text-only, no logo, tighter spacing\n * Best for Engineering, Technical Support, text-focused communication\n */\n\nimport type { FormData } from '../../types';\nimport { escapeHtml } from '../../utils';\nimport { getDarkModeStyles } from '../components/dark-mode';\nimport { buildTier1Links, buildTier2Links } from '../components/contact-tiers';\n\nexport function generate(\n  data: FormData,\n  _websiteUrl: string,\n  zohoSocialHtml: string,\n  accentColor: string,\n  isPreview: boolean\n): string {\n  // Build title line\n  const titleParts: string[] = [];\n  if (data.title) titleParts.push(escapeHtml(data.title));\n  if (data.department) titleParts.push(escapeHtml(data.department));\n  const titleLine = titleParts.join(' | ');\n\n  // Tier 1: Primary Contact (Phone + Email)\n  const tier1Html = buildTier1Links(data, accentColor);\n\n  // Tier 2: Personal Connections (LinkedIn + X + Bookings)\n  const tier2Html = buildTier2Links(data, accentColor);\n\n  return (\n    getDarkModeStyles(isPreview) +\n    `\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333; max-width: 450px;\">\n    <tr>\n        <td>\n            <div class=\"sig-name\" style=\"font-size: 16px; font-weight: bold; color: #333333; margin-bottom: 2px;\">\n                ${escapeHtml(data.name)}\n            </div>\n            ${\n              titleLine\n                ? `\n            <div class=\"sig-title\" style=\"font-size: 13px; color: #666666; margin-bottom: 8px;\">\n                ${titleLine}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier1Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 4px;\">\n                ${tier1Html}\n            </div>\n            `\n                : ''\n            }\n            ${\n              tier2Html\n                ? `\n            <div style=\"font-size: 12px; margin-bottom: 2px;\">\n                ${tier2Html}\n            </div>\n            `\n                : ''\n            }\n            ${zohoSocialHtml}\n        </td>\n    </tr>\n</table>`.trim()\n  );\n}\n","/**\n * Social Links Component\n * Generates Zoho corporate social media links (Tier 3: Company Brand)\n */\n\n/**\n * Generate social media links HTML (Tier 3: Company Brand)\n * \"Follow Zoho:\" section with corporate social accounts\n */\nexport function generateSocialLinks(\n  channels: string[],\n  displayType: string,\n  accentColor: string = '#E42527'\n): string {\n  const socialData: Record<string, { url: string; text: string; icon: string }> = {\n    twitter: { url: 'https://x.com/Zoho', text: 'X', icon: 'ùïè' },\n    linkedin: {\n      url: 'https://www.linkedin.com/company/zoho',\n      text: 'LinkedIn',\n      icon: 'in',\n    },\n    facebook: { url: 'https://www.facebook.com/zoho', text: 'Facebook', icon: 'f' },\n    instagram: {\n      url: 'https://www.instagram.com/zoho/',\n      text: 'Instagram',\n      icon: 'IG',\n    },\n  };\n\n  const links: string[] = [];\n  channels.forEach((channel) => {\n    if (socialData[channel]) {\n      const social = socialData[channel];\n      if (displayType === 'icons') {\n        links.push(\n          `<a href=\"${social.url}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none; font-size: 14px; margin-right: 8px;\" title=\"${social.text}\">${social.icon}</a>`\n        );\n      } else {\n        links.push(\n          `<a href=\"${social.url}\" rel=\"noopener noreferrer\" class=\"sig-link\" style=\"color: ${accentColor}; text-decoration: none;\">${social.text}</a>`\n        );\n      }\n    }\n  });\n\n  const separator =\n    displayType === 'icons' ? '' : ` <span class=\"sig-separator\" style=\"color: ${accentColor};\">‚Ä¢</span> `;\n  const linksHtml = displayType === 'icons' ? links.join('') : links.join(separator);\n\n  return `\n            <div style=\"margin-top: 10px; padding-top: 10px; border-top: 1px solid #E0E0E0;\">\n                <div style=\"font-size: 11px; color: #888888; margin-bottom: 4px;\">Follow Zoho:</div>\n                <div style=\"font-size: 11px;\">\n                    ${linksHtml}\n                </div>\n            </div>\n        `;\n}\n","/**\n * Preview Renderer\n * Manages the live signature preview display\n * Subscribes to event bus for decoupled render triggers\n */\n\nimport type { AppStateManager } from './state';\nimport { SignatureGenerator } from '../signature-generator/index';\nimport { EXAMPLE_DATA } from '../constants';\nimport { eventBus } from '../events';\nimport { debounce } from '../utils';\n\nexport class PreviewRenderer {\n  private stateManager: AppStateManager;\n  private previewContainer: HTMLElement | null;\n  private debouncedRender: () => void;\n\n  constructor(stateManager: AppStateManager) {\n    this.stateManager = stateManager;\n    this.previewContainer = document.getElementById('signaturePreview');\n    this.debouncedRender = debounce(() => this.render(), 300);\n\n    // Subscribe to event bus for decoupled render triggers\n    this.setupEventSubscriptions();\n  }\n\n  /**\n   * Setup event bus subscriptions\n   */\n  private setupEventSubscriptions(): void {\n    // Listen for explicit render requests\n    eventBus.on('preview:render', (payload) => {\n      if (payload.immediate) {\n        this.render();\n      } else {\n        this.debouncedRender();\n      }\n    });\n  }\n\n  /**\n   * Render the signature preview\n   */\n  render(): void {\n    if (!this.previewContainer) {\n      console.warn('Preview container not found');\n      return;\n    }\n\n    const state = this.stateManager.getState();\n    const formData = state.formData;\n\n    // Use example data for empty fields in preview\n    const previewData = { ...formData };\n    Object.keys(previewData).forEach(key => {\n      const fieldKey = key as keyof typeof previewData;\n      if (!previewData[fieldKey] && EXAMPLE_DATA[fieldKey]) {\n        previewData[fieldKey] = EXAMPLE_DATA[fieldKey];\n      }\n    });\n\n    try {\n      // Generate preview HTML (includes dark mode support)\n      const html = SignatureGenerator.generatePreview(\n        previewData,\n        state.signatureStyle,\n        state.socialOptions,\n        state.accentColor\n      );\n\n      // Update preview container\n      this.previewContainer.innerHTML = html;\n\n      // Apply dark mode class to parent .preview-container (CSS targets that element)\n      const container = this.previewContainer.closest('.preview-container');\n      if (container) {\n        if (state.isDarkModePreview) {\n          container.classList.add('dark-mode');\n        } else {\n          container.classList.remove('dark-mode');\n        }\n      }\n    } catch (error) {\n      console.error('Failed to render preview:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      this.previewContainer.innerHTML = `\n        <p style=\"color: #666; font-size: 14px; padding: 20px; text-align: center;\">\n          Unable to generate preview. ${errorMessage.includes('style') ? 'Please select a valid signature style.' : 'Please check your input fields.'}\n        </p>\n      `;\n      eventBus.emit('preview:rendered', { success: false });\n      return;\n    }\n\n    eventBus.emit('preview:rendered', { success: true });\n  }\n\n  /**\n   * Update the preview (alias for render)\n   */\n  updatePreview(): void {\n    this.render();\n  }\n\n  /**\n   * Toggle dark mode preview\n   */\n  toggleDarkMode(enabled: boolean): void {\n    this.stateManager.setDarkModePreview(enabled);\n    this.render();\n  }\n}\n","/**\n * Clipboard Manager\n * Handles copying signature HTML to clipboard with modern and fallback APIs\n */\n\nimport type { AppStateManager } from './state';\nimport { SignatureGenerator } from '../signature-generator/index';\nimport { ANIMATION_DURATIONS } from '../constants';\n\nexport class ClipboardManager {\n  private stateManager: AppStateManager;\n  private toastContainer: HTMLElement | null;\n\n  constructor(stateManager: AppStateManager) {\n    this.stateManager = stateManager;\n    this.toastContainer = document.getElementById('toast');\n  }\n\n  /**\n   * Copy signature HTML to clipboard\n   * Returns true on success, false on failure\n   */\n  async copySignature(): Promise<boolean> {\n    const state = this.stateManager.getState();\n\n    try {\n      // Generate the actual signature HTML (not preview)\n      const html = SignatureGenerator.generate(\n        state.formData,\n        state.signatureStyle,\n        state.socialOptions,\n        state.accentColor,\n        false  // isPreview = false for actual clipboard copy\n      );\n\n      // Try modern clipboard API first\n      if (navigator.clipboard && typeof navigator.clipboard.write === 'function') {\n        await this.modernClipboard(html);\n        this.showToast('‚úì Signature copied! Ready to paste into your email client.');\n        return true;\n      } else {\n        // Fallback to execCommand\n        await this.fallbackClipboard(html);\n        this.showToast('‚úì Signature copied! Ready to paste into your email client.');\n        return true;\n      }\n    } catch (error) {\n      console.error('Failed to copy signature:', error);\n      this.showToast('‚úó Failed to copy signature. Please try again.', 'error');\n      return false;\n    }\n  }\n\n  /**\n   * Modern clipboard API (supports HTML + plain text)\n   */\n  private async modernClipboard(html: string): Promise<void> {\n    try {\n      // Create blob with HTML content\n      const htmlBlob = new Blob([html], { type: 'text/html' });\n\n      // Create plain text version (strip HTML tags)\n      const plainText = this.htmlToPlainText(html);\n      const textBlob = new Blob([plainText], { type: 'text/plain' });\n\n      // Write both formats to clipboard\n      const clipboardItem = new ClipboardItem({\n        'text/html': htmlBlob,\n        'text/plain': textBlob\n      });\n\n      await navigator.clipboard.write([clipboardItem]);\n    } catch (error) {\n      console.error('Modern clipboard failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Fallback clipboard using execCommand\n   */\n  private async fallbackClipboard(html: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        // Create a temporary container\n        const tempContainer = document.createElement('div');\n        tempContainer.style.position = 'fixed';\n        tempContainer.style.left = '-9999px';\n        tempContainer.contentEditable = 'true';\n        tempContainer.innerHTML = html;\n\n        document.body.appendChild(tempContainer);\n\n        // Select the content\n        const range = document.createRange();\n        range.selectNodeContents(tempContainer);\n\n        const selection = window.getSelection();\n        if (!selection) {\n          throw new Error('Could not get window selection');\n        }\n\n        selection.removeAllRanges();\n        selection.addRange(range);\n\n        // Copy to clipboard\n        const success = document.execCommand('copy');\n\n        // Clean up\n        selection.removeAllRanges();\n        document.body.removeChild(tempContainer);\n\n        if (success) {\n          resolve();\n        } else {\n          reject(new Error('execCommand copy failed'));\n        }\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Convert HTML to plain text (simple implementation)\n   */\n  private htmlToPlainText(html: string): string {\n    const temp = document.createElement('div');\n    temp.innerHTML = html;\n    return temp.textContent || temp.innerText || '';\n  }\n\n  /**\n   * Show toast notification\n   */\n  showToast(message: string, type: 'success' | 'error' = 'success'): void {\n    if (!this.toastContainer) {\n      console.warn('Toast container not found');\n      return;\n    }\n\n    // Set message and type\n    this.toastContainer.textContent = message;\n    this.toastContainer.className = `toast ${type}`;\n    this.toastContainer.classList.add('show');\n\n    // Hide after duration\n    setTimeout(() => {\n      this.toastContainer?.classList.remove('show');\n    }, ANIMATION_DURATIONS.TOAST);\n  }\n}\n","/**\n * Modal Controller\n * Manages modal dialog functionality (import instructions)\n */\n\nexport type EmailClientType = 'zoho-mail' | 'zoho-desk' | 'gmail' | 'apple-mail' | 'outlook';\n\ninterface ModalInstructions {\n  title: string;\n  header: string;\n  body: string;\n}\n\nexport class ModalController {\n  private static modal: HTMLElement | null = null;\n  private static closeButton: HTMLElement | null = null;\n  private static backdrop: HTMLElement | null = null;\n  private static handleTabKey: ((e: KeyboardEvent) => void) | null = null;\n  private static handleEscapeKey: ((e: KeyboardEvent) => void) | null = null;\n\n  /**\n   * Initialize modal controller\n   */\n  static init(): void {\n    this.modal = document.getElementById('import-modal');\n\n    if (!this.modal) {\n      console.warn('Modal element not found. Modal functionality disabled.');\n      return;\n    }\n\n    this.closeButton = this.modal.querySelector('.modal-close');\n    this.backdrop = this.modal.querySelector('.modal-backdrop');\n\n    if (!this.closeButton || !this.backdrop) {\n      console.warn('Modal child elements missing. Modal may not function correctly.');\n    }\n\n    this.setupEventListeners();\n  }\n\n  /**\n   * Setup event listeners for modal\n   */\n  private static setupEventListeners(): void {\n    if (!this.modal) return;\n\n    // Close button click\n    if (this.closeButton) {\n      this.closeButton.addEventListener('click', () => {\n        this.close();\n      });\n    }\n\n    // Backdrop click to close\n    if (this.backdrop) {\n      this.backdrop.addEventListener('click', () => {\n        this.close();\n      });\n    }\n\n    // Note: Escape key listener is added/removed in open()/close() to prevent memory leaks\n\n    // Prevent modal content clicks from closing\n    const modalContent = this.modal.querySelector('.modal-content');\n    if (modalContent) {\n      modalContent.addEventListener('click', (e) => {\n        e.stopPropagation();\n      });\n    }\n  }\n\n  /**\n   * Open the modal with client-specific content\n   */\n  static open(clientType: EmailClientType = 'zoho-mail'): void {\n    if (!this.modal) {\n      console.warn('Cannot open modal: modal element not initialized');\n      return;\n    }\n\n    // Update modal content based on client type\n    this.updateContent(clientType);\n\n    this.modal.classList.add('active');\n    this.modal.setAttribute('aria-hidden', 'false');\n\n    // Add Escape key listener\n    this.handleEscapeKey = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        this.close();\n      }\n    };\n    document.addEventListener('keydown', this.handleEscapeKey);\n\n    // Trap focus inside modal\n    this.trapFocus();\n\n    // Prevent body scroll\n    document.body.style.overflow = 'hidden';\n  }\n\n  /**\n   * Update modal content for specific email client\n   */\n  private static updateContent(clientType: EmailClientType): void {\n    if (!this.modal) return;\n\n    const modalHeader = this.modal.querySelector('#modal-header-content');\n    const modalBody = this.modal.querySelector('#modal-body-content');\n\n    if (!modalHeader || !modalBody) {\n      console.warn('Modal header or body not found');\n      return;\n    }\n\n    const content = this.getClientInstructions(clientType);\n\n    // Inject header + close button\n    modalHeader.innerHTML = content.header + `\n      <button type=\"button\" class=\"modal-close\" aria-label=\"Close modal\">√ó</button>\n    `;\n\n    // Re-attach close button event listener\n    const closeButton = modalHeader.querySelector('.modal-close');\n    if (closeButton) {\n      closeButton.addEventListener('click', () => {\n        this.close();\n      });\n    }\n\n    // Inject body\n    modalBody.innerHTML = content.body;\n  }\n\n  /**\n   * Get instructions for specific email client\n   * NOTE: This is a simplified version. The full implementation would include\n   * all the HTML templates from modal.js lines 124-503\n   */\n  private static getClientInstructions(clientType: EmailClientType): ModalInstructions {\n    const instructions: Record<EmailClientType, ModalInstructions> = {\n      'zoho-mail': {\n        title: 'Zoho Mail',\n        header: `\n          <div class=\"modal-header-with-logo\">\n            <img src=\"assets/mail-full.svg\" alt=\"Zoho Mail logo\" class=\"modal-logo-badge\">\n            <div class=\"modal-header-title-group\">\n              <h2 id=\"modalTitle\">Zoho Mail</h2>\n              <div class=\"modal-time-estimate\" aria-label=\"Estimated time 1 minute, 5 steps total\">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        `,\n        body: `\n          <ol class=\"instruction-steps\" aria-label=\"Import instructions\" style=\"--step-color: #E42527;\">\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">1</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  <button class=\"inline-copy-btn\" onclick=\"copySignatureFromModal(event)\" aria-label=\"Copy signature to clipboard\">\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <path d=\"M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z\"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">2</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Open <a href=\"https://mail.zoho.com\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"external-link\">Zoho Mail</a> ‚Üí <strong>Settings</strong> ‚Üí <strong>Signature</strong>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">3</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Select your signature, then click the <strong>Insert HTML</strong> button\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">4</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Paste using <kbd data-key=\"‚åòV\"></kbd> or <kbd data-key=\"Ctrl+V\"></kbd>, then click <strong>Insert</strong>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">5</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click <strong>Update</strong> to save your signature\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class=\"tip-box-new pro-tip\" role=\"note\">\n            <span class=\"tip-icon\" aria-label=\"Tip\">üí°</span>\n            <div class=\"tip-content\">\n              <strong>Tip:</strong> Test your signature by composing a new email.\n            </div>\n          </div>\n        `\n      },\n      'zoho-desk': {\n        title: 'Zoho Desk',\n        header: `\n          <div class=\"modal-header-with-logo\">\n            <img src=\"assets/desk-full.svg\" alt=\"Zoho Desk logo\" class=\"modal-logo-badge\">\n            <div class=\"modal-header-title-group\">\n              <h2 id=\"modalTitle\">Zoho Desk</h2>\n              <div class=\"modal-time-estimate\" aria-label=\"Estimated time 2 minutes, 6 steps total\">\n                ~2 minutes ‚Ä¢ 6 steps\n              </div>\n            </div>\n          </div>\n        `,\n        body: `\n          <ol class=\"instruction-steps\" aria-label=\"Import instructions\" style=\"--step-color: #E42527;\">\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">1</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  <button class=\"inline-copy-btn\" onclick=\"copySignatureFromModal(event)\" aria-label=\"Copy signature to clipboard\">\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <path d=\"M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z\"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">2</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Open <a href=\"https://desk.zoho.com\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"external-link\">Zoho Desk</a> ‚Üí <strong>Settings</strong> (gear icon) ‚Üí <strong>Preferences</strong> ‚Üí <strong>Signature</strong> and select your department from the dropdown at the top\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">3</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click the <strong>Insert</strong> button on the right side of the interface\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">4</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  In the dialog box that appears, paste the HTML using <kbd data-key=\"‚åòV\"></kbd> or <kbd data-key=\"Ctrl+V\"></kbd>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">5</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click <strong>Insert</strong> in the dialog ‚Äî you'll see a preview of your signature in the editor\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">6</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click the blue <strong>Save</strong> button at the bottom of the screen\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class=\"tip-box-new pro-tip\" role=\"note\">\n            <span class=\"tip-icon\" aria-label=\"Tip\">üí°</span>\n            <div class=\"tip-content\">\n              <strong>Tip:</strong> You can create different signatures for different departments.\n            </div>\n          </div>\n        `\n      },\n      'gmail': {\n        title: 'Gmail',\n        header: `\n          <div class=\"modal-header-with-logo\">\n            <img src=\"assets/gmail-logo.svg\" alt=\"Gmail logo\" class=\"modal-logo-badge\">\n            <div class=\"modal-header-title-group\">\n              <h2 id=\"modalTitle\">Gmail</h2>\n              <div class=\"modal-time-estimate\" aria-label=\"Estimated time 1 minute, 5 steps total\">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        `,\n        body: `\n          <ol class=\"instruction-steps\" aria-label=\"Import instructions\" style=\"--step-color: #EA4335;\">\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">1</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  <button class=\"inline-copy-btn\" onclick=\"copySignatureFromModal(event)\" aria-label=\"Copy signature to clipboard\">\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <path d=\"M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z\"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">2</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Open <a href=\"https://mail.google.com\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"external-link\">Gmail</a> ‚Üí Click ‚öôÔ∏è <strong>Settings</strong> ‚Üí <strong>See all settings</strong>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">3</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Scroll down to <strong>Signature</strong> section and click <strong>Create new</strong>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">4</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Give it a name, then paste using <kbd data-key=\"‚åòV\"></kbd> or <kbd data-key=\"Ctrl+V\"></kbd> directly into the signature box\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">5</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Scroll to bottom and click <strong>Save Changes</strong>\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class=\"tip-box-new warning\" role=\"note\">\n            <span class=\"tip-icon\" aria-label=\"Note\">‚ö†Ô∏è</span>\n            <div class=\"tip-content\">\n              <strong>Note:</strong> Gmail may modify some formatting. Test by sending an email to yourself.\n            </div>\n          </div>\n        `\n      },\n      'apple-mail': {\n        title: 'Apple Mail',\n        header: `\n          <div class=\"modal-header-with-logo\">\n            <img src=\"assets/apple-mail-logo.svg\" alt=\"Apple Mail logo\" class=\"modal-logo-badge\">\n            <div class=\"modal-header-title-group\">\n              <h2 id=\"modalTitle\">Apple Mail</h2>\n              <div class=\"modal-time-estimate\" aria-label=\"Estimated time 1 minute, 5 steps total\">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        `,\n        body: `\n          <ol class=\"instruction-steps\" aria-label=\"Import instructions\" style=\"--step-color: #007AFF;\">\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">1</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  <button class=\"inline-copy-btn\" onclick=\"copySignatureFromModal(event)\" aria-label=\"Copy signature to clipboard\">\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <path d=\"M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z\"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">2</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Open Mail app ‚Üí <strong>Mail</strong> menu (top left) ‚Üí <strong>Settings</strong>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">3</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click <strong>Signatures</strong> tab ‚Üí Select your email account ‚Üí Click <strong>+</strong> button\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">4</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  <strong>Uncheck \"Always match my default message font\"</strong> (important!), then paste using <kbd data-key=\"‚åòV\"></kbd>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">5</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Close Settings window to save automatically\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class=\"tip-box-new success\" role=\"note\">\n            <span class=\"tip-icon\" aria-label=\"Success\">‚úÖ</span>\n            <div class=\"tip-content\">\n              <strong>Great choice!</strong> Apple Mail has excellent support for HTML signatures.\n            </div>\n          </div>\n        `\n      },\n      'outlook': {\n        title: 'Outlook',\n        header: `\n          <div class=\"modal-header-with-logo\">\n            <img src=\"assets/outlook-logo.svg\" alt=\"Outlook logo\" class=\"modal-logo-badge\">\n            <div class=\"modal-header-title-group\">\n              <h2 id=\"modalTitle\">Outlook</h2>\n              <div class=\"modal-time-estimate\" aria-label=\"Estimated time 1 minute, 5 steps total\">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        `,\n        body: `\n          <ol class=\"instruction-steps\" aria-label=\"Import instructions\" style=\"--step-color: #0078D4;\">\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">1</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  <button class=\"inline-copy-btn\" onclick=\"copySignatureFromModal(event)\" aria-label=\"Copy signature to clipboard\">\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <path d=\"M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z\"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">2</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Open Outlook ‚Üí <strong>File</strong> ‚Üí <strong>Options</strong> ‚Üí <strong>Mail</strong>\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">3</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click <strong>Signatures...</strong> button in the \"Compose messages\" section\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">4</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click <strong>New</strong>, give it a name, then paste using <kbd data-key=\"Ctrl+V\"></kbd> into the editor box\n                </div>\n              </div>\n            </li>\n            <li class=\"instruction-step\">\n              <div class=\"step-number\" aria-hidden=\"true\">5</div>\n              <div class=\"step-content\">\n                <div class=\"step-title\">\n                  Click <strong>OK</strong> to save your signature\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class=\"tip-box-new warning\" role=\"note\">\n            <span class=\"tip-icon\" aria-label=\"Warning\">‚ö†Ô∏è</span>\n            <div class=\"tip-content\">\n              <strong>Note:</strong> Outlook may display signatures differently. Test in a draft email to verify.\n            </div>\n          </div>\n        `\n      }\n    };\n\n    return instructions[clientType] || instructions['zoho-mail'];\n  }\n\n  /**\n   * Close the modal\n   */\n  static close(): void {\n    if (!this.modal) return;\n\n    this.modal.classList.remove('active');\n    this.modal.setAttribute('aria-hidden', 'true');\n\n    // Restore body scroll\n    document.body.style.overflow = '';\n\n    // Clean up Escape key listener\n    if (this.handleEscapeKey) {\n      document.removeEventListener('keydown', this.handleEscapeKey);\n      this.handleEscapeKey = null;\n    }\n\n    // Clean up focus trap event listener\n    if (this.handleTabKey) {\n      document.removeEventListener('keydown', this.handleTabKey);\n      this.handleTabKey = null;\n    }\n  }\n\n  /**\n   * Check if modal is open\n   */\n  static isOpen(): boolean {\n    return this.modal?.classList.contains('active') || false;\n  }\n\n  /**\n   * Trap focus inside modal for accessibility\n   */\n  private static trapFocus(): void {\n    if (!this.modal) return;\n\n    const focusableElements = this.modal.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n\n    const firstElement = focusableElements[0] as HTMLElement;\n    const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;\n\n    // Focus first element when modal opens\n    setTimeout(() => {\n      if (firstElement) {\n        firstElement.focus();\n      }\n    }, 100);\n\n    // Remove any existing handler\n    if (this.handleTabKey) {\n      document.removeEventListener('keydown', this.handleTabKey);\n    }\n\n    // Trap focus within modal\n    this.handleTabKey = (e: KeyboardEvent) => {\n      if (!this.isOpen()) return;\n\n      if (e.key === 'Tab') {\n        if (e.shiftKey) {\n          // Shift + Tab\n          if (document.activeElement === firstElement) {\n            e.preventDefault();\n            lastElement.focus();\n          }\n        } else {\n          // Tab\n          if (document.activeElement === lastElement) {\n            e.preventDefault();\n            firstElement.focus();\n          }\n        }\n      }\n    };\n\n    document.addEventListener('keydown', this.handleTabKey);\n  }\n}\n","/**\n * Help Panel Controller\n * Manages expandable help panels for form fields\n */\n\nimport { HELP_CONTENT } from '../constants';\n\n/**\n * Announce message to screen readers via live region\n */\nfunction announceToScreenReader(message: string): void {\n  // Find or create live region\n  let liveRegion = document.getElementById('sr-announcements');\n  if (!liveRegion) {\n    liveRegion = document.createElement('div');\n    liveRegion.id = 'sr-announcements';\n    liveRegion.className = 'sr-only';\n    liveRegion.setAttribute('aria-live', 'polite');\n    liveRegion.setAttribute('aria-atomic', 'true');\n    document.body.appendChild(liveRegion);\n  }\n\n  // Clear and set new message (triggers announcement)\n  liveRegion.textContent = '';\n  setTimeout(() => {\n    liveRegion!.textContent = message;\n  }, 100);\n}\n\nexport class HelpPanelController {\n  private static abortController: AbortController | null = null;\n  private static openPanelField: string | null = null;\n\n  /**\n   * Initialize help panel controller\n   * Finds all help icons and sets up event handlers\n   */\n  static init(): void {\n    // Clean up any existing listeners\n    this.cleanup();\n\n    // Create new AbortController for this session\n    this.abortController = new AbortController();\n    const { signal } = this.abortController;\n\n    // Find all help icons\n    const helpIcons = document.querySelectorAll<HTMLElement>('.help-icon[data-field]');\n\n    helpIcons.forEach((icon) => {\n      const fieldId = icon.dataset.field;\n      if (!fieldId || !HELP_CONTENT[fieldId]) {\n        return;\n      }\n\n      // Create help panel for this field\n      this.createHelpPanel(icon, fieldId);\n\n      // Set up ARIA attributes on icon\n      const panelId = `help-panel-${fieldId}`;\n      icon.setAttribute('role', 'button');\n      icon.setAttribute('tabindex', '0');\n      icon.setAttribute('aria-expanded', 'false');\n      icon.setAttribute('aria-controls', panelId);\n      icon.setAttribute('aria-label', `Help for ${HELP_CONTENT[fieldId].title}`);\n\n      // Click handler\n      icon.addEventListener(\n        'click',\n        () => {\n          this.togglePanel(fieldId);\n        },\n        { signal }\n      );\n\n      // Keyboard handler (Space/Enter to toggle)\n      icon.addEventListener(\n        'keydown',\n        (e: KeyboardEvent) => {\n          if (e.key === ' ' || e.key === 'Enter') {\n            e.preventDefault();\n            this.togglePanel(fieldId);\n          }\n        },\n        { signal }\n      );\n    });\n\n    // Global Escape key handler to close all panels\n    document.addEventListener(\n      'keydown',\n      (e: KeyboardEvent) => {\n        if (e.key === 'Escape' && this.openPanelField) {\n          this.closeAllPanels();\n        }\n      },\n      { signal }\n    );\n\n    if (import.meta.env.DEV) {\n      console.log(`HelpPanelController initialized with ${helpIcons.length} help icons`);\n    }\n  }\n\n  /**\n   * Create help panel HTML and insert into DOM\n   */\n  private static createHelpPanel(icon: HTMLElement, fieldId: string): void {\n    const content = HELP_CONTENT[fieldId];\n    if (!content) return;\n\n    const panelId = `help-panel-${fieldId}`;\n\n    // Check if panel already exists\n    if (document.getElementById(panelId)) {\n      return;\n    }\n\n    // Create help panel element\n    const panel = document.createElement('div');\n    panel.id = panelId;\n    panel.className = 'help-panel';\n    panel.setAttribute('role', 'region');\n    panel.setAttribute('aria-labelledby', `help-title-${fieldId}`);\n\n    panel.innerHTML = `\n      <h4 id=\"help-title-${fieldId}\">${content.title}</h4>\n      <p>${content.content}</p>\n    `;\n\n    // Find the parent input-group and insert panel after the grid row\n    const inputGroup = icon.closest('.input-group');\n    if (inputGroup) {\n      // Insert panel as the last child of input-group (will span columns via CSS)\n      inputGroup.appendChild(panel);\n    }\n  }\n\n  /**\n   * Toggle a specific help panel\n   */\n  private static togglePanel(fieldId: string): void {\n    const panel = document.getElementById(`help-panel-${fieldId}`);\n    const icon = document.querySelector<HTMLElement>(`.help-icon[data-field=\"${fieldId}\"]`);\n\n    if (!panel || !icon) return;\n\n    const isCurrentlyOpen = panel.classList.contains('visible');\n\n    // Close any other open panels first\n    if (this.openPanelField && this.openPanelField !== fieldId) {\n      this.closePanel(this.openPanelField);\n    }\n\n    if (isCurrentlyOpen) {\n      // Close this panel\n      this.closePanel(fieldId);\n    } else {\n      // Open this panel\n      this.openPanel(fieldId);\n    }\n  }\n\n  /**\n   * Open a specific help panel\n   */\n  private static openPanel(fieldId: string): void {\n    const panel = document.getElementById(`help-panel-${fieldId}`);\n    const icon = document.querySelector<HTMLElement>(`.help-icon[data-field=\"${fieldId}\"]`);\n    const content = HELP_CONTENT[fieldId];\n\n    if (!panel || !icon || !content) return;\n\n    panel.classList.add('visible');\n    icon.setAttribute('aria-expanded', 'true');\n    this.openPanelField = fieldId;\n\n    // Announce to screen readers\n    announceToScreenReader(`${content.title} help expanded`);\n  }\n\n  /**\n   * Close a specific help panel\n   */\n  private static closePanel(fieldId: string): void {\n    const panel = document.getElementById(`help-panel-${fieldId}`);\n    const icon = document.querySelector<HTMLElement>(`.help-icon[data-field=\"${fieldId}\"]`);\n    const content = HELP_CONTENT[fieldId];\n\n    if (!panel || !icon) return;\n\n    panel.classList.remove('visible');\n    icon.setAttribute('aria-expanded', 'false');\n\n    if (this.openPanelField === fieldId) {\n      this.openPanelField = null;\n    }\n\n    // Announce to screen readers\n    if (content) {\n      announceToScreenReader(`${content.title} help collapsed`);\n    }\n  }\n\n  /**\n   * Close all open help panels\n   */\n  static closeAllPanels(): void {\n    const openPanels = document.querySelectorAll('.help-panel.visible');\n    openPanels.forEach((panel) => {\n      const fieldId = panel.id.replace('help-panel-', '');\n      this.closePanel(fieldId);\n    });\n    this.openPanelField = null;\n  }\n\n  /**\n   * Clean up event listeners\n   */\n  static cleanup(): void {\n    if (this.abortController) {\n      this.abortController.abort();\n      this.abortController = null;\n    }\n    this.openPanelField = null;\n  }\n}\n","/**\n * Drag & Drop Handler\n * Manages drag-and-drop reordering for social media channels\n */\n\nimport type { AppStateManager } from '../app/state';\nimport type { PreviewRenderer } from '../app/preview-renderer';\nimport type { SocialChannel } from '../types';\nimport { eventBus } from '../events';\n\nconst VALID_CHANNELS: SocialChannel[] = ['linkedin', 'twitter', 'instagram', 'facebook'];\n\nfunction isValidChannel(channel: string): channel is SocialChannel {\n  return VALID_CHANNELS.includes(channel as SocialChannel);\n}\n\nexport class DragDropHandler {\n  private stateManager: AppStateManager;\n  private previewRenderer: PreviewRenderer;\n  private draggedElement: HTMLElement | null = null;\n\n  constructor(stateManager: AppStateManager, previewRenderer: PreviewRenderer) {\n    this.stateManager = stateManager;\n    this.previewRenderer = previewRenderer;\n  }\n\n  /**\n   * Initialize drag-drop functionality\n   */\n  initialize(): void {\n    this.setupDragListeners();\n    this.setupCardClickHandlers();\n    this.setupMasterToggle();\n  }\n\n  /**\n   * Setup drag-and-drop event listeners\n   */\n  private setupDragListeners(): void {\n    const socialCards = document.querySelectorAll('.social-compact-card');\n\n    socialCards.forEach((card) => {\n      const htmlCard = card as HTMLElement;\n\n      // Make draggable\n      htmlCard.setAttribute('draggable', 'true');\n\n      // Drag start\n      htmlCard.addEventListener('dragstart', (e) => {\n        this.handleDragStart(e as DragEvent);\n      });\n\n      // Drag over\n      htmlCard.addEventListener('dragover', (e) => {\n        e.preventDefault();  // Allow drop\n        this.handleDragOver(e as DragEvent);\n      });\n\n      // Drop\n      htmlCard.addEventListener('drop', (e) => {\n        e.preventDefault();\n        this.handleDrop(e as DragEvent);\n      });\n\n      // Drag end\n      htmlCard.addEventListener('dragend', () => {\n        this.handleDragEnd();\n      });\n    });\n  }\n\n  /**\n   * Handle drag start\n   */\n  private handleDragStart(event: DragEvent): void {\n    this.draggedElement = event.target as HTMLElement;\n    this.draggedElement.classList.add('dragging');\n\n    if (event.dataTransfer) {\n      event.dataTransfer.effectAllowed = 'move';\n      event.dataTransfer.setData('text/html', this.draggedElement.innerHTML);\n    }\n  }\n\n  /**\n   * Handle drag over\n   */\n  private handleDragOver(event: DragEvent): void {\n    const target = event.target as HTMLElement;\n    const card = target.closest('.social-compact-card') as HTMLElement;\n\n    if (card && card !== this.draggedElement) {\n      // Visual feedback\n      card.classList.add('drag-over');\n    }\n  }\n\n  /**\n   * Handle drop\n   */\n  private handleDrop(event: DragEvent): void {\n    if (!this.draggedElement) return;\n\n    const target = event.target as HTMLElement;\n    const dropTarget = target.closest('.social-compact-card') as HTMLElement;\n\n    if (dropTarget && dropTarget !== this.draggedElement) {\n      const container = dropTarget.parentElement;\n      if (!container) return;\n\n      // Determine drop position\n      const rect = dropTarget.getBoundingClientRect();\n      const midpoint = (rect.left + rect.right) / 2;\n      const insertBefore = event.clientX < midpoint;\n\n      // Reorder DOM elements\n      if (insertBefore) {\n        container.insertBefore(this.draggedElement, dropTarget);\n      } else {\n        container.insertBefore(this.draggedElement, dropTarget.nextSibling);\n      }\n\n      // Save new order\n      this.saveOrder();\n    }\n  }\n\n  /**\n   * Handle drag end (cleanup)\n   */\n  private handleDragEnd(): void {\n    // Remove visual feedback\n    document.querySelectorAll('.social-compact-card').forEach((card) => {\n      card.classList.remove('dragging', 'drag-over');\n    });\n\n    this.draggedElement = null;\n  }\n\n  /**\n   * Save channel order to state and localStorage\n   */\n  private saveOrder(): void {\n    const cards = document.querySelectorAll('.social-compact-card.active');\n    const order = Array.from(cards)\n      .map((card) => (card as HTMLElement).dataset.channel || '')\n      .filter((ch): ch is SocialChannel => isValidChannel(ch));\n\n    // Update state with validated channels\n    this.stateManager.setSocialOptions({ channels: order });\n    this.stateManager.saveSocialOrder();\n\n    // Emit event for decoupled updates\n    eventBus.emit('social:changed', { channels: order });\n\n    // Re-render preview\n    this.previewRenderer.render();\n  }\n\n  /**\n   * Setup card click handlers for toggle on/off\n   */\n  private setupCardClickHandlers(): void {\n    const socialCards = document.querySelectorAll('.social-compact-card');\n\n    socialCards.forEach((card) => {\n      const htmlCard = card as HTMLElement;\n\n      // Set initial aria-checked based on active class\n      htmlCard.setAttribute('aria-checked', String(htmlCard.classList.contains('active')));\n\n      htmlCard.addEventListener('click', () => {\n        // Prevent toggle during drag\n        if (this.draggedElement) return;\n\n        // Toggle active state\n        htmlCard.classList.toggle('active');\n        htmlCard.setAttribute('aria-checked', String(htmlCard.classList.contains('active')));\n\n        // Update state with active channels and re-render preview\n        this.updateActiveChannels();\n      });\n    });\n  }\n\n  /**\n   * Get active channels from DOM and update state\n   */\n  private updateActiveChannels(): void {\n    const activeCards = document.querySelectorAll('.social-compact-card.active');\n    const activeChannels = Array.from(activeCards)\n      .map((card) => (card as HTMLElement).dataset.channel || '')\n      .filter((ch): ch is SocialChannel => isValidChannel(ch));\n\n    // Update state with validated active channels\n    this.stateManager.setSocialOptions({ channels: activeChannels });\n\n    // Emit event for decoupled updates\n    eventBus.emit('social:changed', { channels: activeChannels });\n\n    // Re-render preview\n    this.previewRenderer.render();\n  }\n\n  /**\n   * Setup master social toggle\n   */\n  private setupMasterToggle(): void {\n    const masterToggle = document.getElementById('master-social-toggle');\n    if (!masterToggle) return;\n\n    masterToggle.addEventListener('click', () => {\n      const isActive = masterToggle.classList.contains('active');\n      const newState = !isActive;\n\n      // Toggle visual state\n      masterToggle.classList.toggle('active');\n      masterToggle.setAttribute('aria-checked', String(newState));\n\n      // Toggle all social cards\n      const socialCards = document.querySelectorAll('.social-compact-card');\n      socialCards.forEach((card) => {\n        const htmlCard = card as HTMLElement;\n        if (newState) {\n          htmlCard.classList.add('active');\n        } else {\n          htmlCard.classList.remove('active');\n        }\n        htmlCard.setAttribute('aria-checked', String(newState));\n      });\n\n      // Update state and re-render preview\n      this.updateActiveChannels();\n    });\n  }\n}\n","/**\n * Main Entry Point\n * Initializes all application modules\n */\n\n// Import styles\nimport '@/styles/main.css';\n\nimport { AppStateManager } from './app/state';\nimport { FormHandler } from './app/form-handler';\nimport { PreviewRenderer } from './app/preview-renderer';\nimport { ClipboardManager } from './app/clipboard';\nimport { ModalController } from './ui/modal';\nimport { HelpPanelController } from './ui/help-panel';\nimport { DragDropHandler } from './ui/drag-drop';\n\n// Initialize application when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  if (import.meta.env.DEV) {\n    console.log('Zoho Signature Generator - Initializing...');\n  }\n\n  // Initialize state manager\n  const state = new AppStateManager();\n  state.loadFromStorage();\n\n  // Initialize preview renderer\n  const previewRenderer = new PreviewRenderer(state);\n\n  // Initialize form handler\n  const formHandler = new FormHandler(state, previewRenderer);\n  formHandler.initialize();\n\n  // Initialize clipboard manager\n  const clipboardManager = new ClipboardManager(state);\n\n  // Note: ThemeManager removed - dark mode is ONLY for signature preview section,\n  // not for the entire app. See previewRenderer.toggleDarkMode() below.\n\n  // Initialize drag-drop handler\n  const dragDropHandler = new DragDropHandler(state, previewRenderer);\n  dragDropHandler.initialize();\n\n  // Initialize modal controller\n  ModalController.init();\n\n  // Initialize help panel controller\n  HelpPanelController.init();\n\n  // Render initial preview\n  previewRenderer.render();\n\n  // Setup copy button\n  const copyButton = document.getElementById('copyButton');\n  if (copyButton) {\n    copyButton.addEventListener('click', async () => {\n      await clipboardManager.copySignature();\n    });\n  }\n\n  // Setup dark mode preview toggle\n  const darkModePreviewToggle = document.getElementById('themeToggle') as HTMLInputElement;\n  if (darkModePreviewToggle) {\n    darkModePreviewToggle.addEventListener('change', () => {\n      previewRenderer.toggleDarkMode(darkModePreviewToggle.checked);\n    });\n  }\n\n  // Setup import instruction buttons\n  const importButtons = document.querySelectorAll('[data-client]');\n  importButtons.forEach((button) => {\n    button.addEventListener('click', () => {\n      const clientType = (button as HTMLElement).dataset.client;\n      if (clientType) {\n        ModalController.open(clientType as any);\n      }\n    });\n  });\n\n  // Expose copySignatureFromModal globally for modal inline onclick handlers\n  (window as any).copySignatureFromModal = async (event: Event) => {\n    event.preventDefault();\n    await clipboardManager.copySignature();\n  };\n\n  // Setup feedback button to open feedback modal\n  const feedbackButton = document.getElementById('feedbackButton');\n  const feedbackModal = document.getElementById('feedback-modal');\n  if (feedbackButton && feedbackModal) {\n    feedbackButton.addEventListener('click', () => {\n      feedbackModal.classList.add('active');\n      feedbackModal.setAttribute('aria-hidden', 'false');\n      document.body.style.overflow = 'hidden';\n    });\n\n    // Close feedback modal on backdrop click or close button\n    const feedbackBackdrop = feedbackModal.querySelector('.modal-backdrop');\n    const feedbackCloseBtn = feedbackModal.querySelector('.modal-close');\n\n    const closeFeedbackModal = () => {\n      feedbackModal.classList.remove('active');\n      feedbackModal.setAttribute('aria-hidden', 'true');\n      document.body.style.overflow = '';\n    };\n\n    feedbackBackdrop?.addEventListener('click', closeFeedbackModal);\n    feedbackCloseBtn?.addEventListener('click', closeFeedbackModal);\n\n    // Close on Escape key\n    document.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape' && feedbackModal.classList.contains('active')) {\n        closeFeedbackModal();\n      }\n    });\n  }\n\n  // Expose state for debugging (development only)\n  if (import.meta.env.DEV) {\n    (window as any).AppState = state;\n    (window as any).PreviewRenderer = previewRenderer;\n    (window as any).ClipboardManager = clipboardManager;\n    console.log('Initialization complete');\n  }\n});\n"],"names":["PRESERVED_ACRONYMS","LOWERCASE_WORDS","EXAMPLE_DATA","name","title","department","email","phone","linkedin","twitter","bookings","website","HELP_CONTENT","content","STORAGE_KEYS","ANIMATION_DURATIONS","deepFreeze","obj","Object","freeze","getOwnPropertyNames","forEach","prop","value","isFrozen","AppStateManager","constructor","this","state","formData","fieldToggles","signatureStyle","socialOptions","enabled","channels","displayType","isDarkModePreview","accentColor","formatLockState","getState","getFormData","updateFormData","field","updateFormDataBatch","data","safeKeys","updates","key","updateFieldToggle","setSignatureStyle","style","getSignatureStyle","setSocialOptions","options","setAccentColor","color","saveAccentColor","getAccentColor","setDarkModePreview","toggleFormatLock","newValue","saveFormatLock","getFormatLock","setFormatLock","loadFromStorage","savedColor","localStorage","getItem","savedOrder","JSON","parse","validChannels","Array","isArray","length","every","ch","includes","console","warn","e","formatLockUpdates","saved","keys","setItem","saveSocialOrder","stringify","String","escapeHtml","text","div","document","createElement","textContent","innerHTML","sanitizeSocialUrl","input","domain","urlObj","URL","startsWith","hostname","replace","pathname","RegExp","toLowerCase","getTrackedWebsiteURL","emailPrefix","sanitized","trim","URLSearchParams","utm_source","utm_medium","utm_campaign","toString","debounce","func","wait","timeout","args","context","clearTimeout","setTimeout","apply","ZOHOCORP_EMAIL_REGEX","EMAIL_REGEX","isValidUrl","url","normalized","match","inputValidator","validate","trimmedValue","validateEmail","validatePhone","validateLinkedIn","validateTwitter","validateBookings","validateWebsite","validateName","validateText","createResult","validateAll","results","entries","result","isValid","push","test","prefix","split","endsWith","message","eventBus","handlers","Map","on","event","handler","has","set","Set","get","add","unsubscribe","delete","once","subscription","payload","emit","error","off","clear","listenerCount","_a","size","FormHandler","stateManager","previewRenderer","userEditedEmailPrefix","formatLockAbortController","debouncedRender","render","initialize","setupInputListeners","setupToggleListeners","setupStyleSelector","setupAccentColorSelector","setupFormatLockIcons","setupSmartTitleCase","setupWebsiteTracking","setupClearButtons","nameInput","getElementById","addEventListener","target","handleFieldChange","emailPrefixInput","fullName","parts","generateEmailPrefix","handleEmailPrefixChange","validateField","linkedinUsernameInput","cleaned","fullUrl","twitterUsernameInput","bookingsIdInput","fieldId","cleanPrefix","fullEmail","inputId","inputElement","inputGroup","closest","validationIcon","querySelector","iconContent","className","display","setAttribute","querySelectorAll","toggle","dataset","classList","contains","disabled","radio","checked","label","colorButtons","button","btn","remove","abort","AbortController","signal","icon","newState","applyFormatting","preserveCursor","cursorPos","selectionStart","str","finalResult","map","word","index","charAt","toUpperCase","slice","join","acronym","regex","toSmartTitleCase","setSelectionRange","trackedUrl","initialTrackedUrl","preventDefault","getDarkModeStyles","isPreview","generateDualLogos","websiteUrl","height","logos","baseUrl","light","dark","getLogoUrls","buildTier1Links","tier1Links","buildTier2Links","tier2Links","linkedinUrl","xHandle","STYLE_GENERATORS","classic","zohoSocialHtml","titleParts","titleLine","tier1Html","tier2Html","professional","compact","modern","creative","minimal","_websiteUrl","SignatureGenerator","generate","socialData","facebook","instagram","links","channel","social","separator","generateSocialLinks","generator","generateWithFallback","styleName","classicError","generateFallbackSignature","generatePreview","validateStyle","PreviewRenderer","previewContainer","setupEventSubscriptions","immediate","previewData","fieldKey","html","container","errorMessage","Error","success","updatePreview","toggleDarkMode","ClipboardManager","toastContainer","copySignature","navigator","clipboard","write","modernClipboard","showToast","fallbackClipboard","htmlBlob","Blob","type","plainText","htmlToPlainText","textBlob","clipboardItem","ClipboardItem","Promise","resolve","reject","tempContainer","position","left","contentEditable","body","appendChild","range","createRange","selectNodeContents","selection","window","getSelection","removeAllRanges","addRange","execCommand","removeChild","temp","innerText","_ModalController","init","modal","closeButton","backdrop","setupEventListeners","close","modalContent","stopPropagation","open","clientType","updateContent","handleEscapeKey","trapFocus","overflow","modalHeader","modalBody","getClientInstructions","header","instructions","gmail","outlook","removeEventListener","handleTabKey","isOpen","focusableElements","firstElement","lastElement","focus","shiftKey","activeElement","ModalController","announceToScreenReader","liveRegion","id","_HelpPanelController","cleanup","abortController","createHelpPanel","panelId","togglePanel","openPanelField","closeAllPanels","panel","isCurrentlyOpen","closePanel","openPanel","HelpPanelController","VALID_CHANNELS","isValidChannel","DragDropHandler","draggedElement","setupDragListeners","setupCardClickHandlers","setupMasterToggle","card","htmlCard","handleDragStart","handleDragOver","handleDrop","handleDragEnd","dataTransfer","effectAllowed","setData","dropTarget","parentElement","rect","getBoundingClientRect","midpoint","right","clientX","insertBefore","nextSibling","saveOrder","cards","order","from","filter","updateActiveChannels","activeCards","activeChannels","masterToggle","clipboardManager","copyButton","async","darkModePreviewToggle","client","copySignatureFromModal","feedbackButton","feedbackModal","feedbackBackdrop","feedbackCloseBtn","closeFeedbackModal"],"mappings":"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"}