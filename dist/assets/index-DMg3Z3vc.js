!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const e=["VP","SVP","EVP","CEO","CTO","CFO","COO","CMO","CIO","iOS","API","UI","UX","IT","HR","B2B","B2C","SaaS","SMB"],t=["a","an","the","and","but","or","nor","of","at","by","for","in","on","to","up","with","as"],n={name:"Jasmine Frank",title:"Director of Marketing",department:"Zoho One",email:"jasmine.frank@zohocorp.com",phone:"+1 (281) 330-8004",linkedin:"https://linkedin.com/in/jasminefrank",twitter:"https://x.com/jasminefrank",bookings:"",website:"https://www.zoho.com"},i={"email-prefix":{title:"Email Format",content:'Enter your email prefix only (e.g., "jasmine.frank"). The @zohocorp.com domain is automatically added.'},phone:{title:"Phone Format",content:"Enter your phone number with country code. Examples: +1 (281) 330-8004 or +91 44 2344 9876"},"linkedin-username":{title:"LinkedIn Username",content:"Enter just your LinkedIn username, not the full URL. Find it in your profile URL: linkedin.com/in/YOUR-USERNAME"},"twitter-username":{title:"X Handle",content:"Enter your X handle without the @ symbol. This will link to your X profile."},"bookings-id":{title:"Zoho Bookings ID",content:"Enter your Zoho Bookings calendar ID. Find this in Zoho Bookings under Settings > Share > Embed Code."}},s="signature-accent-color",a="socialChannelOrder",o="format-lock-",l=3e3;function r(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{const n=e[t];null===n||"object"!=typeof n||Object.isFrozen(n)||r(n)}),e}class c{constructor(){this.state={formData:{name:"",title:"",department:"",email:"",phone:"",linkedin:"",twitter:"",bookings:"",website:"https://www.zoho.com"},fieldToggles:{title:!0,department:!0,email:!0,phone:!0,linkedin:!1,twitter:!1,bookings:!1,website:!1},signatureStyle:"classic",socialOptions:{enabled:!0,channels:["linkedin","twitter","instagram","facebook"],displayType:"text"},isDarkModePreview:!1,accentColor:"#E42527",formatLockState:{name:!0,title:!0,department:!0}}}getState(){return r({...this.state})}getFormData(){return r({...this.state.formData})}updateFormData(e,t){this.state={...this.state,formData:{...this.state.formData,[e]:t}}}updateFormDataBatch(e){const t=["name","title","department","email","phone","linkedin","twitter","bookings","website"],n={};for(const i of t)i in e&&void 0!==e[i]&&(n[i]=e[i]);this.state={...this.state,formData:{...this.state.formData,...n}}}updateFieldToggle(e,t){this.state={...this.state,fieldToggles:{...this.state.fieldToggles,[e]:t}}}setSignatureStyle(e){this.state={...this.state,signatureStyle:e}}getSignatureStyle(){return this.state.signatureStyle}setSocialOptions(e){this.state={...this.state,socialOptions:{...this.state.socialOptions,...e}}}setAccentColor(e){this.state={...this.state,accentColor:e},this.saveAccentColor(e)}getAccentColor(){return this.state.accentColor}setDarkModePreview(e){this.state={...this.state,isDarkModePreview:e}}toggleFormatLock(e){const t=!this.state.formatLockState[e];this.state={...this.state,formatLockState:{...this.state.formatLockState,[e]:t}},this.saveFormatLock(e,t)}getFormatLock(e){return this.state.formatLockState[e]}setFormatLock(e,t){this.state={...this.state,formatLockState:{...this.state.formatLockState,[e]:t}},this.saveFormatLock(e,t)}loadFromStorage(){let e={};const t=localStorage.getItem(s);t&&(e.accentColor=t);const n=localStorage.getItem(a);if(n)try{const t=JSON.parse(n),i=["linkedin","twitter","instagram","facebook"];Array.isArray(t)&&t.length<=4&&t.every(e=>"string"==typeof e&&i.includes(e))?e.socialOptions={...this.state.socialOptions,channels:t}:console.warn("Invalid social order format in localStorage, using defaults")}catch(l){console.warn("Failed to parse saved social order:",l)}const i={};["name","title","department"].forEach(e=>{const t=`${o}${e}`,n=localStorage.getItem(t);null!==n&&(i[e]="false"!==n)}),Object.keys(i).length>0&&(e.formatLockState={...this.state.formatLockState,...i}),Object.keys(e).length>0&&(this.state={...this.state,...e})}saveAccentColor(e){localStorage.setItem(s,e)}saveSocialOrder(){localStorage.setItem(a,JSON.stringify(this.state.socialOptions.channels))}saveFormatLock(e,t){const n=`${o}${e}`;localStorage.setItem(n,String(t))}}function d(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function p(e,t){if(!e)return"";try{const n=new URL(e.startsWith("http")?e:"https://"+e),i=n.hostname.replace(/^www\./,"");if(i===t||i==="www."+t)return n.pathname.replace(/^\/+/,"").replace(/\/+$/,"")}catch{}return e.replace(/^https?:\/\//i,"").replace(/^www\./i,"").replace(new RegExp(`^${t}/?`,"i"),"").replace(/^\/+/,"").replace(/\/+$/,"").replace(/^@/,"").replace(/\s+/g,"").toLowerCase()}function u(e){const t=e.trim().replace(/[^a-zA-Z0-9.\-_]/g,"")||"zoho-employee";return`https://www.zoho.com?${new URLSearchParams({utm_source:"email-signature",utm_medium:"signature",utm_campaign:t}).toString()}`}function h(e,t){let n=null;return function(...i){const s=this;null!==n&&clearTimeout(n),n=setTimeout(()=>{e.apply(s,i)},t)}}const m=/^[a-z0-9.]+@zohocorp\.com$/i,g=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function v(e){try{const t=e.match(/^https?:\/\//)?e:"https://"+e.replace(/^\/+/,"");return new URL(t),!0}catch{return!1}}const b=new class{validate(e,t){const n=t.trim();switch(e){case"email":return this.validateEmail(n);case"phone":return this.validatePhone(n);case"linkedin":return this.validateLinkedIn(n);case"twitter":return this.validateTwitter(n);case"bookings":return this.validateBookings(n);case"website":return this.validateWebsite(n);case"name":return this.validateName(n);case"title":case"department":return this.validateText(e,n);default:return this.createResult(e,n,!0,null)}}validateAll(e){const t=[];for(const[n,i]of Object.entries(e))if(void 0!==i){const e=this.validate(n,i);e.isValid||t.push(e)}return t}isValid(e,t){return this.validate(e,t).isValid}validateEmail(e){if(!e)return this.createResult("email",e,!0,null);if(!m.test(e))return g.test(e)?this.createResult("email",e,!1,"Must use @zohocorp.com domain"):this.createResult("email",e,!1,"Invalid email format. Example: john.doe@zohocorp.com");const t=e.split("@")[0];return t.length<2?this.createResult("email",e,!1,"Email prefix needs at least 2 characters"):t.startsWith(".")||t.endsWith(".")||t.includes("..")?this.createResult("email",e,!1,"Dots cannot be at start, end, or consecutive"):this.createResult("email",e,!0,null)}validatePhone(e){if(!e)return this.createResult("phone",e,!0,null);return e.replace(/\D/g,"").length<10?this.createResult("phone",e,!1,"Must have at least 10 digits. Example: +1 (281) 330-8004"):this.createResult("phone",e,!0,null)}validateLinkedIn(e){return e&&e.includes("linkedin.com")&&!v(e)?this.createResult("linkedin",e,!1,"Invalid LinkedIn URL format"):this.createResult("linkedin",e,!0,null)}validateTwitter(e){return e?!e.includes("x.com")&&!e.includes("twitter.com")||v(e)?this.createResult("twitter",e,!0,null):this.createResult("twitter",e,!1,"Invalid X/Twitter URL format"):this.createResult("twitter",e,!0,null)}validateBookings(e){return e&&e.includes("bookings.zohocorp.com")&&!v(e)?this.createResult("bookings",e,!1,"Invalid Bookings URL format"):this.createResult("bookings",e,!0,null)}validateWebsite(e){return e?v(e)?this.createResult("website",e,!0,null):this.createResult("website",e,!1,"Invalid URL format"):this.createResult("website",e,!0,null)}validateName(e){return e&&e.length<2?this.createResult("name",e,!1,"Name must be at least 2 characters"):this.createResult("name",e,!0,null)}validateText(e,t){return t&&t.length>100?this.createResult(e,t,!1,"Text is too long (max 100 characters)"):this.createResult(e,t,!0,null)}createResult(e,t,n,i){return{field:e,value:t,isValid:n,message:i}}};const f=new class{constructor(){this.handlers=new Map}on(e,t){this.handlers.has(e)||this.handlers.set(e,new Set);const n=this.handlers.get(e);return n.add(t),{unsubscribe:()=>{n.delete(t)}}}once(e,t){const n=this.on(e,e=>{n.unsubscribe(),t(e)});return n}emit(e,t){const n=this.handlers.get(e);n&&n.forEach(n=>{try{n(t)}catch(i){console.error(`Event handler error for "${e}":`,i)}})}off(e){this.handlers.delete(e)}clear(){this.handlers.clear()}listenerCount(e){var t;return(null==(t=this.handlers.get(e))?void 0:t.size)||0}};class y{constructor(e,t){this.userEditedEmailPrefix=!1,this.formatLockAbortController=null,this.stateManager=e,this.previewRenderer=t,this.debouncedRender=h(()=>this.previewRenderer.render(),300)}initialize(){this.setupInputListeners(),this.setupToggleListeners(),this.setupStyleSelector(),this.setupAccentColorSelector(),this.setupFormatLockIcons(),this.setupSmartTitleCase(),this.setupWebsiteTracking(),this.setupClearButtons()}setupInputListeners(){const e=document.getElementById("name");e&&e.addEventListener("input",e=>{const t=e.target.value;this.handleFieldChange("name",t);const n=document.getElementById("email-prefix");if(n&&!this.userEditedEmailPrefix){const e=function(e){const t=e.trim().toLowerCase().split(/\s+/);if(t.length>=2)return`${t[0].replace(/[^a-z]/g,"")}.${t[t.length-1].replace(/[^a-z]/g,"")}`;return 1===t.length&&t[0]?t[0].replace(/[^a-z]/g,""):""}(t);n.value=e,this.handleEmailPrefixChange(e)}});const t=document.getElementById("email-prefix");t&&(t.addEventListener("input",e=>{const t=e.target.value.toLowerCase();e.target.value=t,this.userEditedEmailPrefix=!0,this.handleEmailPrefixChange(t)}),t.addEventListener("blur",e=>{const t=e.target.value;this.validateField("email",`${t}@zohocorp.com`)}));const n=document.getElementById("linkedin-username");n&&(n.addEventListener("input",e=>{const t=p(e.target.value,"linkedin.com"),n=t?`https://linkedin.com/in/${t}`:"";this.handleFieldChange("linkedin",n)}),n.addEventListener("blur",e=>{const t=e.target.value;if(t){const n=p(t,"linkedin.com");e.target.value=n}}));const i=document.getElementById("twitter-username");i&&(i.addEventListener("input",e=>{const t=p(e.target.value,"x.com"),n=t?`https://x.com/${t}`:"";this.handleFieldChange("twitter",n)}),i.addEventListener("blur",e=>{const t=e.target.value;if(t){const n=p(t,"x.com");e.target.value=n}}));const s=document.getElementById("bookings-id");s&&s.addEventListener("input",e=>{const t=e.target.value,n=t?`https://bookings.zohocorp.com/#/${t}`:"";this.handleFieldChange("bookings",n)}),["title","department","phone"].forEach(e=>{const t=document.getElementById(e);t&&(t.addEventListener("input",t=>{const n=t.target.value;this.handleFieldChange(e,n)}),t.addEventListener("blur",t=>{const n=t.target.value;this.validateField(e,n)}))})}handleEmailPrefixChange(e){const t=e.replace(/@zohocorp\.com$/i,"").trim(),n=t?`${t}@zohocorp.com`:"";this.handleFieldChange("email",n)}handleFieldChange(e,t){this.stateManager.updateFormData(e,t),f.emit("form:changed",{field:e,value:t}),this.debouncedRender()}validateField(e,t){const n={email:"email-prefix",linkedin:"linkedin-username",twitter:"twitter-username",bookings:"bookings-id",phone:"phone"}[e]||e,i=document.getElementById(n),s=null==i?void 0:i.closest(".input-group"),a=null==s?void 0:s.querySelector(".validation-icon");if(!a)return!0;const o=b.validate(e,t);let l="";return"email"!==e&&"phone"!==e||(t&&!o.isValid?l="‚úó":t&&(l="‚úì")),l?(a.textContent=l,a.className=o.isValid?"validation-icon valid":"validation-icon invalid",a.style.display="flex",a.setAttribute("aria-label",o.message?`‚úó ${o.message}`:"Valid")):a.style.display="none",o.isValid}setupToggleListeners(){document.querySelectorAll(".toggle-switch[data-field]:not(.social-toggle)").forEach(e=>{const t=e.dataset.field;t&&e.addEventListener("click",()=>{const n=!e.classList.contains("active");e.classList.toggle("active"),e.setAttribute("aria-checked",String(n));const i=this.stateManager.getState().fieldToggles;if(t in i){this.stateManager.updateFieldToggle(t,n);let e=t;"email"===t?e="email-prefix":"linkedin"===t?e="linkedin-username":"twitter"===t?e="twitter-username":"bookings"===t&&(e="bookings-id");const i=document.getElementById(e);i&&(i.disabled=!n,n||(i.value="",this.handleFieldChange(t,""))),this.previewRenderer.render()}})})}setupStyleSelector(){document.querySelectorAll('input[name="signatureStyle"]').forEach(e=>{e.addEventListener("change",e=>{const t=e.target;if(t.checked){const e=t.value;this.stateManager.setSignatureStyle(e),f.emit("style:changed",{style:e}),this.previewRenderer.render()}});const t=e.closest(".style-option");t&&t.addEventListener("click",()=>{if(!e.checked){e.checked=!0;const t=e.value;this.stateManager.setSignatureStyle(t),this.previewRenderer.render()}})})}setupAccentColorSelector(){const e=document.querySelectorAll(".color-btn");e.forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.color;n&&(e.forEach(e=>e.classList.remove("selected")),t.classList.add("selected"),this.stateManager.setAccentColor(n),f.emit("color:changed",{color:n}),this.previewRenderer.render())})})}setupFormatLockIcons(){this.formatLockAbortController&&this.formatLockAbortController.abort(),this.formatLockAbortController=new AbortController;const{signal:e}=this.formatLockAbortController;document.querySelectorAll(".format-lock-icon").forEach(t=>{const n=t.dataset.field;this.stateManager.getFormatLock(n)?t.setAttribute("title","Title Case ON - formats as you type"):(t.classList.remove("locked"),t.setAttribute("title","Title Case OFF - click to enable auto-capitalization")),t.addEventListener("click",()=>{this.stateManager.toggleFormatLock(n);const e=this.stateManager.getFormatLock(n);t.classList.toggle("locked"),t.setAttribute("title",e?"Title Case ON - formats as you type":"Title Case OFF - click to enable auto-capitalization")},{signal:e})})}setupSmartTitleCase(){["name","title","department"].forEach(n=>{const i=document.getElementById(n);if(!i)return;const s=(s=!1)=>{if(this.stateManager.getFormatLock(n)&&i.value.trim()){const a=s?i.selectionStart:null;i.value=function(n){if(!n||"string"!=typeof n)return n;let i=n.toLowerCase().split(/\s+/).map((e,n)=>0===n?e.charAt(0).toUpperCase()+e.slice(1):t.includes(e)?e:e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return e.forEach(e=>{const t=new RegExp("\\b"+e+"\\b","gi");i=i.replace(t,e)}),i}(i.value),this.handleFieldChange(n,i.value),s&&null!==a&&i.setSelectionRange(a,a)}};i.addEventListener("input",()=>s(!0)),i.addEventListener("blur",()=>s(!1)),i.addEventListener("paste",()=>{setTimeout(()=>s(!1),10)})})}setupWebsiteTracking(){const e=document.getElementById("email-prefix");e&&e.addEventListener("input",()=>{const t=u(e.value.trim());this.stateManager.updateFormData("website",t),this.debouncedRender()});const t=u((null==e?void 0:e.value.trim())||"zoho-employee");this.stateManager.updateFormData("website",t)}setupClearButtons(){document.querySelectorAll(".clear-btn").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.dataset.field;if(!n)return;const i=document.getElementById(n);i&&(i.value="",this.handleFieldChange(n,""))})})}}function k(e=!1){return e?"\n<style>\n  /* Dark mode styles - ONLY for preview toggle (ignores system preference) */\n  .dark-mode .sig-name { color: #FFFFFF !important; }\n  .dark-mode .sig-title { color: #E0E0E0 !important; }\n  /* Note: .sig-link uses inline accent color - no override needed */\n  .dark-mode .sig-separator { color: #666666 !important; }\n  .dark-mode .sig-logo-light { display: none !important; }\n  .dark-mode .sig-logo-dark { display: inline-block !important; }\n\n  /* Default: hide dark logo */\n  .sig-logo-dark { display: none; }\n</style>".trim():"\n<style>\n  /* Dark mode styles - applies when email client uses dark mode */\n  @media (prefers-color-scheme: dark) {\n    /* Text colors - High contrast for WCAG AA compliance */\n    .sig-name { color: #FFFFFF !important; }\n    .sig-title { color: #E0E0E0 !important; }\n    /* Note: .sig-link uses inline accent color - no override needed */\n    .sig-separator { color: #666666 !important; }\n\n    /* Logo switching - hide light, show dark */\n    .sig-logo-light { display: none !important; }\n    .sig-logo-dark { display: inline-block !important; }\n  }\n\n  /* Also apply dark mode when container has .dark-mode class (for preview toggle) */\n  .dark-mode .sig-name { color: #FFFFFF !important; }\n  .dark-mode .sig-title { color: #E0E0E0 !important; }\n  /* Note: .sig-link uses inline accent color - no override needed */\n  .dark-mode .sig-separator { color: #666666 !important; }\n  .dark-mode .sig-logo-light { display: none !important; }\n  .dark-mode .sig-logo-dark { display: inline-block !important; }\n\n  /* Default: hide dark logo */\n  .sig-logo-dark { display: none; }\n</style>".trim()}function w(e,t=32){const n=function(){const e="https://tejasgadhia.github.io/zoho-signature-generator/assets";return{light:`${e}/zoho-logo-light.png`,dark:`${e}/zoho-logo-dark.png`}}();return`\n<a href="${e}" rel="noopener noreferrer" style="text-decoration: none; display: inline-block;">\n    <img src="${n.light}"\n         alt="Zoho"\n         class="sig-logo-light"\n         style="height: ${t}px; display: block; border: 0;"\n         height="${t}">\n    <img src="${n.dark}"\n         alt="Zoho"\n         class="sig-logo-dark"\n         style="height: ${t}px; display: none; border: 0;"\n         height="${t}">\n</a>`.trim()}function E(e,t){const n=[];var i;return e.phone&&n.push(`<a href="tel:${i=e.phone,i.replace(/[^\d+]/g,"")}" rel="noopener noreferrer" class="sig-link" style="color: ${t}; text-decoration: none;">${d(e.phone)}</a>`),e.email&&n.push(`<a href="mailto:${d(e.email)}" rel="noopener noreferrer" class="sig-link" style="color: ${t}; text-decoration: none;">${d(e.email)}</a>`),n.length>0?n.join(` <span class="sig-separator" style="color: ${t};">‚Ä¢</span> `):""}function x(e,t){const n=[];if(e.linkedin){const i=`https://www.linkedin.com/${p(e.linkedin,"linkedin.com")}`;n.push(`<a href="${i}" rel="noopener noreferrer" class="sig-link" style="color: ${t}; text-decoration: none;">LinkedIn</a>`)}if(e.twitter){const i=p(e.twitter,"x.com").replace("@","");n.push(`<a href="https://x.com/${i}" rel="noopener noreferrer" class="sig-link" style="color: ${t}; text-decoration: none;">X</a>`)}return e.bookings&&n.push(`<a href="${d(e.bookings)}" rel="noopener noreferrer" class="sig-link" style="color: ${t}; text-decoration: none;">Book a Meeting</a>`),n.length>0?n.join(` <span class="sig-separator" style="color: ${t};">‚Ä¢</span> `):""}const L={classic:function(e,t,n,i,s){const a=[];e.title&&a.push(d(e.title)),e.department&&a.push(d(e.department));const o=a.join(" | "),l=E(e,i),r=x(e,i);return k(s)+`\n<table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;">\n    <tr>\n        <td style="padding-bottom: 10px;">\n            ${w(t,34)}\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="sig-name" style="font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;">\n                ${d(e.name)}\n            </div>\n            ${o?`\n            <div class="sig-title" style="font-size: 13px; color: #666666; margin-bottom: 7px;">\n                ${o}\n            </div>\n            `:""}\n            ${l?`\n            <div style="font-size: 12px; margin-bottom: 4px;">\n                ${l}\n            </div>\n            `:""}\n            ${r?`\n            <div style="font-size: 12px; margin-bottom: 2px;">\n                ${r}\n            </div>\n            `:""}\n            ${n}\n        </td>\n    </tr>\n</table>`.trim()},professional:function(e,t,n,i,s){const a=[];e.title&&a.push(d(e.title)),e.department&&a.push(d(e.department));const o=a.join(" | "),l=E(e,i),r=x(e,i);return k(s)+`\n<table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;">\n    <tr>\n        <td style="padding-right: 14px; vertical-align: top; width: 75px;">\n            ${w(t,38)}\n        </td>\n        <td style="vertical-align: top;">\n            <div class="sig-name" style="font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;">\n                ${d(e.name)}\n            </div>\n            ${o?`\n            <div class="sig-title" style="font-size: 13px; color: #666666; margin-bottom: 7px;">\n                ${o}\n            </div>\n            `:""}\n            ${l?`\n            <div style="font-size: 12px; margin-bottom: 4px;">\n                ${l}\n            </div>\n            `:""}\n            ${r?`\n            <div style="font-size: 12px; margin-bottom: 2px;">\n                ${r}\n            </div>\n            `:""}\n            ${n}\n        </td>\n    </tr>\n</table>`.trim()},compact:function(e,t,n,i,s){const a=[];e.title&&a.push(d(e.title)),e.department&&a.push(d(e.department));const o=a.join(" | "),l=E(e,i),r=x(e,i);return k(s)+`\n<table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 12px; line-height: 1.6; color: #333333;">\n    <tr>\n        <td style="padding-right: 10px; vertical-align: middle;">\n            ${w(t,26)}\n        </td>\n        <td style="vertical-align: middle;">\n            <div style="margin-bottom: 3px;">\n                <span class="sig-name" style="font-weight: bold; color: #333333;">${d(e.name)}</span>\n                ${o?`<span class="sig-separator" style="color: ${i};"> ‚Ä¢ </span><span class="sig-title" style="color: #666666;">${o}</span>`:""}\n            </div>\n            ${l?`\n            <div style="margin-bottom: 3px;">\n                ${l}\n            </div>\n            `:""}\n            ${r?`\n            <div style="margin-bottom: 3px;">\n                ${r}\n            </div>\n            `:""}\n            ${n}\n        </td>\n    </tr>\n</table>`.trim()},modern:function(e,t,n,i,s){const a=[];e.title&&a.push(d(e.title)),e.department&&a.push(d(e.department));const o=a.join(" | "),l=E(e,i),r=x(e,i);return k(s)+`\n<table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;">\n    <tr>\n        <td style="padding-right: 14px; vertical-align: top; width: 75px;">\n            ${w(t,38)}\n        </td>\n        <td style="width: 2px; background: ${i}; opacity: 0.3;">&nbsp;</td>\n        <td style="padding-left: 14px; vertical-align: top;">\n            <div class="sig-name" style="font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;">\n                ${d(e.name)}\n            </div>\n            ${o?`\n            <div class="sig-title" style="font-size: 13px; color: #666666; margin-bottom: 7px;">\n                ${o}\n            </div>\n            `:""}\n            ${l?`\n            <div style="font-size: 12px; margin-bottom: 4px;">\n                ${l}\n            </div>\n            `:""}\n            ${r?`\n            <div style="font-size: 12px; margin-bottom: 2px;">\n                ${r}\n            </div>\n            `:""}\n            ${n}\n        </td>\n    </tr>\n</table>`.trim()},creative:function(e,t,n,i,s){const a=[];e.title&&a.push(d(e.title)),e.department&&a.push(d(e.department));const o=a.join(" | "),l=E(e,i),r=x(e,i);return k(s)+`\n<table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333;">\n    <tr>\n        <td style="width: 4px; background: ${i};">&nbsp;</td>\n        <td style="padding-left: 14px; vertical-align: top;">\n            <div style="margin-bottom: 10px;">\n                ${w(t,32)}\n            </div>\n            <div class="sig-name" style="font-size: 15px; font-weight: bold; color: #333333; margin-bottom: 3px;">\n                ${d(e.name)}\n            </div>\n            ${o?`\n            <div class="sig-title" style="font-size: 13px; color: #666666; margin-bottom: 7px;">\n                ${o}\n            </div>\n            `:""}\n            ${l?`\n            <div style="font-size: 12px; margin-bottom: 4px;">\n                ${l}\n            </div>\n            `:""}\n            ${r?`\n            <div style="font-size: 12px; margin-bottom: 2px;">\n                ${r}\n            </div>\n            `:""}\n            ${n}\n        </td>\n    </tr>\n</table>`.trim()},minimal:function(e,t,n,i,s){const a=[];e.title&&a.push(d(e.title)),e.department&&a.push(d(e.department));const o=a.join(" | "),l=E(e,i),r=x(e,i);return k(s)+`\n<table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 13px; line-height: 1.6; color: #333333; max-width: 450px;">\n    <tr>\n        <td>\n            <div class="sig-name" style="font-size: 16px; font-weight: bold; color: #333333; margin-bottom: 2px;">\n                ${d(e.name)}\n            </div>\n            ${o?`\n            <div class="sig-title" style="font-size: 13px; color: #666666; margin-bottom: 8px;">\n                ${o}\n            </div>\n            `:""}\n            ${l?`\n            <div style="font-size: 12px; margin-bottom: 4px;">\n                ${l}\n            </div>\n            `:""}\n            ${r?`\n            <div style="font-size: 12px; margin-bottom: 2px;">\n                ${r}\n            </div>\n            `:""}\n            ${n}\n        </td>\n    </tr>\n</table>`.trim()}};class C{static generate(e,t="classic",n={enabled:!1,channels:[],displayType:"text"},i="#E42527",s=!1){const a=e.website||"https://www.zoho.com";let o="";try{n.enabled&&n.channels&&n.channels.length>0&&(o=function(e,t,n="#E42527"){const i={twitter:{url:"https://x.com/Zoho",text:"X",icon:"ùïè"},linkedin:{url:"https://www.linkedin.com/company/zoho",text:"LinkedIn",icon:"in"},facebook:{url:"https://www.facebook.com/zoho",text:"Facebook",icon:"f"},instagram:{url:"https://www.instagram.com/zoho/",text:"Instagram",icon:"IG"}},s=[];e.forEach(e=>{if(i[e]){const a=i[e];"icons"===t?s.push(`<a href="${a.url}" rel="noopener noreferrer" class="sig-link" style="color: ${n}; text-decoration: none; font-size: 14px; margin-right: 8px;" title="${a.text}">${a.icon}</a>`):s.push(`<a href="${a.url}" rel="noopener noreferrer" class="sig-link" style="color: ${n}; text-decoration: none;">${a.text}</a>`)}});const a="icons"===t?"":` <span class="sig-separator" style="color: ${n};">‚Ä¢</span> `;return`\n            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #E0E0E0;">\n                <div style="font-size: 11px; color: #888888; margin-bottom: 4px;">Follow Zoho:</div>\n                <div style="font-size: 11px;">\n                    ${"icons"===t?s.join(""):s.join(a)}\n                </div>\n            </div>\n        `}(n.channels,n.displayType,i))}catch(r){console.warn("Failed to generate social links, continuing without them:",r),o=""}const l=L[t];return l?this.generateWithFallback(l,e,a,o,i,s,t):(console.warn(`Unknown style "${t}", falling back to classic`),this.generateWithFallback(L.classic,e,a,o,i,s,"classic"))}static generateWithFallback(e,t,n,i,s,a,o){try{return e(t,n,i,s,a)}catch(l){if(console.error(`Style "${o}" failed to generate:`,l),"classic"!==o)try{return console.warn("Falling back to classic style"),L.classic(t,n,i,s,a)}catch(r){console.error("Classic style also failed:",r)}return console.warn("Using emergency fallback signature"),function(e,t){const n=d(e.name||""),i=d(e.title||""),s=d(e.department||""),a=d(e.email||""),o=d(e.phone||"");return`\n    <table cellpadding="0" cellspacing="0" border="0" style="font-family: Verdana, Geneva, sans-serif; font-size: 14px; color: #333333;">\n      <tr>\n        <td style="padding-bottom: 8px;">\n          <strong style="font-size: 16px; color: ${t};">${n}</strong>\n        </td>\n      </tr>\n      ${i?`<tr><td>${i}${s?` | ${s}`:""}</td></tr>`:""}\n      ${a?`<tr><td><a href="mailto:${a}" style="color: ${t}; text-decoration: none;">${a}</a></td></tr>`:""}\n      ${o?`<tr><td>${o}</td></tr>`:""}\n    </table>\n  `.trim()}(t,s)}}static generatePreview(e,t="classic",n={enabled:!1,channels:[],displayType:"text"},i="#E42527"){return e.name?this.generate(e,t,n,i,!0):'\n        <div style="text-align: center; padding: 40px 20px; color: #999999;">\n          <p style="font-size: 16px; margin: 0;">Fill in your name to preview the signature</p>\n        </div>\n      '}static validateStyle(e){return e in L}}class S{constructor(e){this.stateManager=e,this.previewContainer=document.getElementById("signaturePreview"),this.debouncedRender=h(()=>this.render(),300),this.setupEventSubscriptions()}setupEventSubscriptions(){f.on("preview:render",e=>{e.immediate?this.render():this.debouncedRender()})}render(){if(!this.previewContainer)return void console.warn("Preview container not found");const e=this.stateManager.getState(),t={...e.formData};Object.keys(t).forEach(e=>{const i=e;!t[i]&&n[i]&&(t[i]=n[i])});try{const n=C.generatePreview(t,e.signatureStyle,e.socialOptions,e.accentColor);this.previewContainer.innerHTML=n;const i=this.previewContainer.closest(".preview-container");i&&(e.isDarkModePreview?i.classList.add("dark-mode"):i.classList.remove("dark-mode"))}catch(i){console.error("Failed to render preview:",i);const e=i instanceof Error?i.message:"Unknown error";return this.previewContainer.innerHTML=`\n        <p style="color: #666; font-size: 14px; padding: 20px; text-align: center;">\n          Unable to generate preview. ${e.includes("style")?"Please select a valid signature style.":"Please check your input fields."}\n        </p>\n      `,void f.emit("preview:rendered",{success:!1})}f.emit("preview:rendered",{success:!0})}updatePreview(){this.render()}toggleDarkMode(e){this.stateManager.setDarkModePreview(e),this.render()}}class ${constructor(e){this.stateManager=e,this.toastContainer=document.getElementById("toast")}async copySignature(){const e=this.stateManager.getState();try{const t=C.generate(e.formData,e.signatureStyle,e.socialOptions,e.accentColor,!1);return navigator.clipboard&&"function"==typeof navigator.clipboard.write?(await this.modernClipboard(t),this.showToast("‚úì Signature copied! Ready to paste into your email client."),!0):(await this.fallbackClipboard(t),this.showToast("‚úì Signature copied! Ready to paste into your email client."),!0)}catch(t){return console.error("Failed to copy signature:",t),this.showToast("‚úó Failed to copy signature. Please try again.","error"),!1}}async modernClipboard(e){try{const t=new Blob([e],{type:"text/html"}),n=this.htmlToPlainText(e),i=new Blob([n],{type:"text/plain"}),s=new ClipboardItem({"text/html":t,"text/plain":i});await navigator.clipboard.write([s])}catch(t){throw console.error("Modern clipboard failed:",t),t}}async fallbackClipboard(e){return new Promise((t,n)=>{try{const i=document.createElement("div");i.style.position="fixed",i.style.left="-9999px",i.contentEditable="true",i.innerHTML=e,document.body.appendChild(i);const s=document.createRange();s.selectNodeContents(i);const a=window.getSelection();if(!a)throw new Error("Could not get window selection");a.removeAllRanges(),a.addRange(s);const o=document.execCommand("copy");a.removeAllRanges(),document.body.removeChild(i),o?t():n(new Error("execCommand copy failed"))}catch(i){n(i)}})}htmlToPlainText(e){const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}showToast(e,t="success"){this.toastContainer?(this.toastContainer.textContent=e,this.toastContainer.className=`toast ${t}`,this.toastContainer.classList.add("show"),setTimeout(()=>{var e;null==(e=this.toastContainer)||e.classList.remove("show")},l)):console.warn("Toast container not found")}}const F=class{static init(){this.modal=document.getElementById("import-modal"),this.modal?(this.closeButton=this.modal.querySelector(".modal-close"),this.backdrop=this.modal.querySelector(".modal-backdrop"),this.closeButton&&this.backdrop||console.warn("Modal child elements missing. Modal may not function correctly."),this.setupEventListeners()):console.warn("Modal element not found. Modal functionality disabled.")}static setupEventListeners(){if(!this.modal)return;this.closeButton&&this.closeButton.addEventListener("click",()=>{this.close()}),this.backdrop&&this.backdrop.addEventListener("click",()=>{this.close()});const e=this.modal.querySelector(".modal-content");e&&e.addEventListener("click",e=>{e.stopPropagation()})}static open(e="zoho-mail"){this.modal?(this.updateContent(e),this.modal.classList.add("active"),this.modal.setAttribute("aria-hidden","false"),this.handleEscapeKey=e=>{"Escape"===e.key&&this.close()},document.addEventListener("keydown",this.handleEscapeKey),this.trapFocus(),document.body.style.overflow="hidden"):console.warn("Cannot open modal: modal element not initialized")}static updateContent(e){if(!this.modal)return;const t=this.modal.querySelector("#modal-header-content"),n=this.modal.querySelector("#modal-body-content");if(!t||!n)return void console.warn("Modal header or body not found");const i=this.getClientInstructions(e);t.innerHTML=i.header+'\n      <button type="button" class="modal-close" aria-label="Close modal">√ó</button>\n    ';const s=t.querySelector(".modal-close");s&&s.addEventListener("click",()=>{this.close()}),n.innerHTML=i.body}static getClientInstructions(e){const t={"zoho-mail":{title:"Zoho Mail",header:'\n          <div class="modal-header-with-logo">\n            <img src="assets/mail-full.svg" alt="Zoho Mail logo" class="modal-logo-badge">\n            <div class="modal-header-title-group">\n              <h2 id="modalTitle">Zoho Mail</h2>\n              <div class="modal-time-estimate" aria-label="Estimated time 1 minute, 5 steps total">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        ',body:'\n          <ol class="instruction-steps" aria-label="Import instructions" style="--step-color: #E42527;">\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">1</div>\n              <div class="step-content">\n                <div class="step-title">\n                  <button class="inline-copy-btn" onclick="copySignatureFromModal(event)" aria-label="Copy signature to clipboard">\n                    <svg viewBox="0 0 16 16" fill="currentColor">\n                      <path d="M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">2</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Open <a href="https://mail.zoho.com" target="_blank" rel="noopener noreferrer" class="external-link">Zoho Mail</a> ‚Üí <strong>Settings</strong> ‚Üí <strong>Signature</strong>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">3</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Select your signature, then click the <strong>Insert HTML</strong> button\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">4</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Paste using <kbd data-key="‚åòV"></kbd> or <kbd data-key="Ctrl+V"></kbd>, then click <strong>Insert</strong>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">5</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click <strong>Update</strong> to save your signature\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class="tip-box-new pro-tip" role="note">\n            <span class="tip-icon" aria-label="Tip">üí°</span>\n            <div class="tip-content">\n              <strong>Tip:</strong> Test your signature by composing a new email.\n            </div>\n          </div>\n        '},"zoho-desk":{title:"Zoho Desk",header:'\n          <div class="modal-header-with-logo">\n            <img src="assets/desk-full.svg" alt="Zoho Desk logo" class="modal-logo-badge">\n            <div class="modal-header-title-group">\n              <h2 id="modalTitle">Zoho Desk</h2>\n              <div class="modal-time-estimate" aria-label="Estimated time 2 minutes, 6 steps total">\n                ~2 minutes ‚Ä¢ 6 steps\n              </div>\n            </div>\n          </div>\n        ',body:'\n          <ol class="instruction-steps" aria-label="Import instructions" style="--step-color: #E42527;">\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">1</div>\n              <div class="step-content">\n                <div class="step-title">\n                  <button class="inline-copy-btn" onclick="copySignatureFromModal(event)" aria-label="Copy signature to clipboard">\n                    <svg viewBox="0 0 16 16" fill="currentColor">\n                      <path d="M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">2</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Open <a href="https://desk.zoho.com" target="_blank" rel="noopener noreferrer" class="external-link">Zoho Desk</a> ‚Üí <strong>Settings</strong> (gear icon) ‚Üí <strong>Preferences</strong> ‚Üí <strong>Signature</strong> and select your department from the dropdown at the top\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">3</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click the <strong>Insert</strong> button on the right side of the interface\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">4</div>\n              <div class="step-content">\n                <div class="step-title">\n                  In the dialog box that appears, paste the HTML using <kbd data-key="‚åòV"></kbd> or <kbd data-key="Ctrl+V"></kbd>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">5</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click <strong>Insert</strong> in the dialog ‚Äî you\'ll see a preview of your signature in the editor\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">6</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click the blue <strong>Save</strong> button at the bottom of the screen\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class="tip-box-new pro-tip" role="note">\n            <span class="tip-icon" aria-label="Tip">üí°</span>\n            <div class="tip-content">\n              <strong>Tip:</strong> You can create different signatures for different departments.\n            </div>\n          </div>\n        '},gmail:{title:"Gmail",header:'\n          <div class="modal-header-with-logo">\n            <img src="assets/gmail-logo.svg" alt="Gmail logo" class="modal-logo-badge">\n            <div class="modal-header-title-group">\n              <h2 id="modalTitle">Gmail</h2>\n              <div class="modal-time-estimate" aria-label="Estimated time 1 minute, 5 steps total">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        ',body:'\n          <ol class="instruction-steps" aria-label="Import instructions" style="--step-color: #EA4335;">\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">1</div>\n              <div class="step-content">\n                <div class="step-title">\n                  <button class="inline-copy-btn" onclick="copySignatureFromModal(event)" aria-label="Copy signature to clipboard">\n                    <svg viewBox="0 0 16 16" fill="currentColor">\n                      <path d="M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">2</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Open <a href="https://mail.google.com" target="_blank" rel="noopener noreferrer" class="external-link">Gmail</a> ‚Üí Click ‚öôÔ∏è <strong>Settings</strong> ‚Üí <strong>See all settings</strong>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">3</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Scroll down to <strong>Signature</strong> section and click <strong>Create new</strong>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">4</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Give it a name, then paste using <kbd data-key="‚åòV"></kbd> or <kbd data-key="Ctrl+V"></kbd> directly into the signature box\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">5</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Scroll to bottom and click <strong>Save Changes</strong>\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class="tip-box-new warning" role="note">\n            <span class="tip-icon" aria-label="Note">‚ö†Ô∏è</span>\n            <div class="tip-content">\n              <strong>Note:</strong> Gmail may modify some formatting. Test by sending an email to yourself.\n            </div>\n          </div>\n        '},"apple-mail":{title:"Apple Mail",header:'\n          <div class="modal-header-with-logo">\n            <img src="assets/apple-mail-logo.svg" alt="Apple Mail logo" class="modal-logo-badge">\n            <div class="modal-header-title-group">\n              <h2 id="modalTitle">Apple Mail</h2>\n              <div class="modal-time-estimate" aria-label="Estimated time 1 minute, 5 steps total">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        ',body:'\n          <ol class="instruction-steps" aria-label="Import instructions" style="--step-color: #007AFF;">\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">1</div>\n              <div class="step-content">\n                <div class="step-title">\n                  <button class="inline-copy-btn" onclick="copySignatureFromModal(event)" aria-label="Copy signature to clipboard">\n                    <svg viewBox="0 0 16 16" fill="currentColor">\n                      <path d="M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">2</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Open Mail app ‚Üí <strong>Mail</strong> menu (top left) ‚Üí <strong>Settings</strong>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">3</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click <strong>Signatures</strong> tab ‚Üí Select your email account ‚Üí Click <strong>+</strong> button\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">4</div>\n              <div class="step-content">\n                <div class="step-title">\n                  <strong>Uncheck "Always match my default message font"</strong> (important!), then paste using <kbd data-key="‚åòV"></kbd>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">5</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Close Settings window to save automatically\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class="tip-box-new success" role="note">\n            <span class="tip-icon" aria-label="Success">‚úÖ</span>\n            <div class="tip-content">\n              <strong>Great choice!</strong> Apple Mail has excellent support for HTML signatures.\n            </div>\n          </div>\n        '},outlook:{title:"Outlook",header:'\n          <div class="modal-header-with-logo">\n            <img src="assets/outlook-logo.svg" alt="Outlook logo" class="modal-logo-badge">\n            <div class="modal-header-title-group">\n              <h2 id="modalTitle">Outlook</h2>\n              <div class="modal-time-estimate" aria-label="Estimated time 1 minute, 5 steps total">\n                ~1 minute ‚Ä¢ 5 steps\n              </div>\n            </div>\n          </div>\n        ',body:'\n          <ol class="instruction-steps" aria-label="Import instructions" style="--step-color: #0078D4;">\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">1</div>\n              <div class="step-content">\n                <div class="step-title">\n                  <button class="inline-copy-btn" onclick="copySignatureFromModal(event)" aria-label="Copy signature to clipboard">\n                    <svg viewBox="0 0 16 16" fill="currentColor">\n                      <path d="M5.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-8z"/>\n                    </svg>\n                    Copy Signature\n                  </button>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">2</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Open Outlook ‚Üí <strong>File</strong> ‚Üí <strong>Options</strong> ‚Üí <strong>Mail</strong>\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">3</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click <strong>Signatures...</strong> button in the "Compose messages" section\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">4</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click <strong>New</strong>, give it a name, then paste using <kbd data-key="Ctrl+V"></kbd> into the editor box\n                </div>\n              </div>\n            </li>\n            <li class="instruction-step">\n              <div class="step-number" aria-hidden="true">5</div>\n              <div class="step-content">\n                <div class="step-title">\n                  Click <strong>OK</strong> to save your signature\n                </div>\n              </div>\n            </li>\n          </ol>\n          <div class="tip-box-new warning" role="note">\n            <span class="tip-icon" aria-label="Warning">‚ö†Ô∏è</span>\n            <div class="tip-content">\n              <strong>Note:</strong> Outlook may display signatures differently. Test in a draft email to verify.\n            </div>\n          </div>\n        '}};return t[e]||t["zoho-mail"]}static close(){this.modal&&(this.modal.classList.remove("active"),this.modal.setAttribute("aria-hidden","true"),document.body.style.overflow="",this.handleEscapeKey&&(document.removeEventListener("keydown",this.handleEscapeKey),this.handleEscapeKey=null),this.handleTabKey&&(document.removeEventListener("keydown",this.handleTabKey),this.handleTabKey=null))}static isOpen(){var e;return(null==(e=this.modal)?void 0:e.classList.contains("active"))||!1}static trapFocus(){if(!this.modal)return;const e=this.modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),t=e[0],n=e[e.length-1];setTimeout(()=>{t&&t.focus()},100),this.handleTabKey&&document.removeEventListener("keydown",this.handleTabKey),this.handleTabKey=e=>{this.isOpen()&&"Tab"===e.key&&(e.shiftKey?document.activeElement===t&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),t.focus()))},document.addEventListener("keydown",this.handleTabKey)}};F.modal=null,F.closeButton=null,F.backdrop=null,F.handleTabKey=null,F.handleEscapeKey=null;let T=F;function A(e){let t=document.getElementById("sr-announcements");t||(t=document.createElement("div"),t.id="sr-announcements",t.className="sr-only",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),document.body.appendChild(t)),t.textContent="",setTimeout(()=>{t.textContent=e},100)}const z=class{static init(){this.cleanup(),this.abortController=new AbortController;const{signal:e}=this.abortController;document.querySelectorAll(".help-icon[data-field]").forEach(t=>{const n=t.dataset.field;if(!n||!i[n])return;this.createHelpPanel(t,n);const s=`help-panel-${n}`;t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-controls",s),t.setAttribute("aria-label",`Help for ${i[n].title}`),t.addEventListener("click",()=>{this.togglePanel(n)},{signal:e}),t.addEventListener("keydown",e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),this.togglePanel(n))},{signal:e})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.openPanelField&&this.closeAllPanels()},{signal:e})}static createHelpPanel(e,t){const n=i[t];if(!n)return;const s=`help-panel-${t}`;if(document.getElementById(s))return;const a=document.createElement("div");a.id=s,a.className="help-panel",a.setAttribute("role","region"),a.setAttribute("aria-labelledby",`help-title-${t}`),a.innerHTML=`\n      <h4 id="help-title-${t}">${n.title}</h4>\n      <p>${n.content}</p>\n    `;const o=e.closest(".input-group");o&&o.appendChild(a)}static togglePanel(e){const t=document.getElementById(`help-panel-${e}`),n=document.querySelector(`.help-icon[data-field="${e}"]`);if(!t||!n)return;const i=t.classList.contains("visible");this.openPanelField&&this.openPanelField!==e&&this.closePanel(this.openPanelField),i?this.closePanel(e):this.openPanel(e)}static openPanel(e){const t=document.getElementById(`help-panel-${e}`),n=document.querySelector(`.help-icon[data-field="${e}"]`),s=i[e];t&&n&&s&&(t.classList.add("visible"),n.setAttribute("aria-expanded","true"),this.openPanelField=e,A(`${s.title} help expanded`))}static closePanel(e){const t=document.getElementById(`help-panel-${e}`),n=document.querySelector(`.help-icon[data-field="${e}"]`),s=i[e];t&&n&&(t.classList.remove("visible"),n.setAttribute("aria-expanded","false"),this.openPanelField===e&&(this.openPanelField=null),s&&A(`${s.title} help collapsed`))}static closeAllPanels(){document.querySelectorAll(".help-panel.visible").forEach(e=>{const t=e.id.replace("help-panel-","");this.closePanel(t)}),this.openPanelField=null}static cleanup(){this.abortController&&(this.abortController.abort(),this.abortController=null),this.openPanelField=null}};z.abortController=null,z.openPanelField=null;let M=z;const I=["linkedin","twitter","instagram","facebook"];function O(e){return I.includes(e)}class R{constructor(e,t){this.draggedElement=null,this.stateManager=e,this.previewRenderer=t}initialize(){this.setupDragListeners(),this.setupCardClickHandlers(),this.setupMasterToggle()}setupDragListeners(){document.querySelectorAll(".social-compact-card").forEach(e=>{const t=e;t.setAttribute("draggable","true"),t.addEventListener("dragstart",e=>{this.handleDragStart(e)}),t.addEventListener("dragover",e=>{e.preventDefault(),this.handleDragOver(e)}),t.addEventListener("drop",e=>{e.preventDefault(),this.handleDrop(e)}),t.addEventListener("dragend",()=>{this.handleDragEnd()})})}handleDragStart(e){this.draggedElement=e.target,this.draggedElement.classList.add("dragging"),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.draggedElement.innerHTML))}handleDragOver(e){const t=e.target.closest(".social-compact-card");t&&t!==this.draggedElement&&t.classList.add("drag-over")}handleDrop(e){if(!this.draggedElement)return;const t=e.target.closest(".social-compact-card");if(t&&t!==this.draggedElement){const n=t.parentElement;if(!n)return;const i=t.getBoundingClientRect(),s=(i.left+i.right)/2;e.clientX<s?n.insertBefore(this.draggedElement,t):n.insertBefore(this.draggedElement,t.nextSibling),this.saveOrder()}}handleDragEnd(){document.querySelectorAll(".social-compact-card").forEach(e=>{e.classList.remove("dragging","drag-over")}),this.draggedElement=null}saveOrder(){const e=document.querySelectorAll(".social-compact-card.active"),t=Array.from(e).map(e=>e.dataset.channel||"").filter(e=>O(e));this.stateManager.setSocialOptions({channels:t}),this.stateManager.saveSocialOrder(),f.emit("social:changed",{channels:t}),this.previewRenderer.render()}setupCardClickHandlers(){document.querySelectorAll(".social-compact-card").forEach(e=>{const t=e;t.setAttribute("aria-checked",String(t.classList.contains("active"))),t.addEventListener("click",()=>{this.draggedElement||(t.classList.toggle("active"),t.setAttribute("aria-checked",String(t.classList.contains("active"))),this.updateActiveChannels())})})}updateActiveChannels(){const e=document.querySelectorAll(".social-compact-card.active"),t=Array.from(e).map(e=>e.dataset.channel||"").filter(e=>O(e));this.stateManager.setSocialOptions({channels:t}),f.emit("social:changed",{channels:t}),this.previewRenderer.render()}setupMasterToggle(){const e=document.getElementById("master-social-toggle");e&&e.addEventListener("click",()=>{const t=!e.classList.contains("active");e.classList.toggle("active"),e.setAttribute("aria-checked",String(t));document.querySelectorAll(".social-compact-card").forEach(e=>{const n=e;t?n.classList.add("active"):n.classList.remove("active"),n.setAttribute("aria-checked",String(t))}),this.updateActiveChannels()})}}document.addEventListener("DOMContentLoaded",()=>{const e=new c;e.loadFromStorage();const t=new S(e);new y(e,t).initialize();const n=new $(e);new R(e,t).initialize(),T.init(),M.init(),t.render();const i=document.getElementById("copyButton");i&&i.addEventListener("click",async()=>{await n.copySignature()});const s=document.getElementById("themeToggle");s&&s.addEventListener("change",()=>{t.toggleDarkMode(s.checked)});document.querySelectorAll("[data-client]").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.client;t&&T.open(t)})}),window.copySignatureFromModal=async e=>{e.preventDefault(),await n.copySignature()};const a=document.getElementById("feedbackButton"),o=document.getElementById("feedback-modal");if(a&&o){a.addEventListener("click",()=>{o.classList.add("active"),o.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden"});const e=o.querySelector(".modal-backdrop"),t=o.querySelector(".modal-close"),n=()=>{o.classList.remove("active"),o.setAttribute("aria-hidden","true"),document.body.style.overflow=""};null==e||e.addEventListener("click",n),null==t||t.addEventListener("click",n),document.addEventListener("keydown",e=>{"Escape"===e.key&&o.classList.contains("active")&&n()})}});
//# sourceMappingURL=index-DMg3Z3vc.js.map
