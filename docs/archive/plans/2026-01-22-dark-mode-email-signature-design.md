# Dark Mode Email Signature Support - Design Document

**Date:** January 22, 2026
**Version:** v0.6.0 (Phase 2 completion)
**Status:** Approved
**Author:** Brainstorming session with Claude

---

## Overview

Implement full dark mode support for email signatures generated by the Zoho Email Signature Generator. This ensures signatures are readable when viewed in dark mode email clients (Gmail Dark Mode, Apple Mail Dark Mode, etc.).

**Scope:** Items 9 & 10 from PHASE-2-PLAN.md (Priority 3: Professional Polish)

---

## Problem Statement

Currently, email signatures use hardcoded dark colors (`#333`, `#666`) that become unreadable when viewed in dark mode email clients:

- **Name text** (`#333333`) is nearly invisible on dark backgrounds
- **Title/Department** (`#666666`) has poor contrast
- **Zoho logo** (dark text on transparent) disappears on dark backgrounds
- **Links** blend into text, losing visual hierarchy

**Email clients with dark mode:**
- ✅ Gmail (web + mobile) - Full `@media` query support
- ✅ Apple Mail (macOS + iOS) - Full `@media` query support
- ⚠️ Outlook (web) - Partial support
- ❌ Outlook (desktop) - Strips `<style>` tags

---

## Design Goals

1. **Readability** - Text must meet WCAG AA contrast in both light and dark modes
2. **Brand consistency** - Zoho logo must be visible on all backgrounds
3. **Graceful degradation** - Legacy email clients should fall back to light mode (still readable)
4. **Email client compatibility** - Work in 80%+ of email clients
5. **Maintainability** - Easy to update logo URLs and colors

---

## Solution: Hybrid CSS + Inline Styles Approach

We'll use a **hybrid strategy** that combines modern CSS media queries with inline style fallbacks:

### Strategy A: Modern Email Clients (Gmail, Apple Mail)
- `<style>` block with `@media (prefers-color-scheme: dark)` queries
- CSS classes on text elements (`.sig-name`, `.sig-title`, etc.)
- Dual logo implementation (show/hide based on color scheme)

### Strategy B: Legacy Email Clients (Outlook Desktop)
- Inline styles as fallback
- Display light mode colors (still readable)
- Show light logo only

**Result:** Best of both worlds - modern clients get full dark mode, legacy clients get readable light mode.

---

## Architecture

### File Changes

**New Assets (to download from https://www.zoho.com/branding/):**
- `assets/zoho-logo-light.png` - Current logo for light backgrounds
- `assets/zoho-logo-dark.png` - White/light logo for dark backgrounds

**Code Changes:**
1. **`js/signature.js`** (major changes)
   - Add `getDarkModeStyles()` helper function
   - Add `getLogoUrls()` helper function
   - Update all 4 signature styles (Classic, Compact, Modern, Minimal)
   - Add CSS classes to all text elements
   - Implement dual logo strategy

2. **`js/app.js`** (no changes needed)
   - State management remains unchanged

3. **`css/styles.css`** (optional)
   - Preview styles already support dark mode toggle

---

## Implementation Details

### 1. Dark Mode CSS Style Block

Every signature will start with this `<style>` block:

```html
<style>
  @media (prefers-color-scheme: dark) {
    /* Text colors - High contrast for readability */
    .sig-name { color: #FFFFFF !important; }
    .sig-title { color: #E0E0E0 !important; }
    .sig-link { color: #4A9EFF !important; }
    .sig-separator { color: #666666 !important; }

    /* Logo switching - hide light, show dark */
    .sig-logo-light { display: none !important; }
    .sig-logo-dark { display: inline-block !important; }
  }

  /* Default: hide dark logo */
  .sig-logo-dark { display: none; }
</style>
```

**Why `!important`?**
- Email clients often inject their own styles
- `!important` ensures our dark mode styles take precedence
- Inline fallback styles won't conflict (lower specificity)

---

### 2. Color Mapping

| Element | Light Mode | Dark Mode | Contrast Ratio | Reasoning |
|---------|-----------|-----------|----------------|-----------|
| Name (primary) | `#333333` | `#FFFFFF` | 21:1 (AAA) | Maximum contrast, clear hierarchy |
| Title/Department | `#666666` | `#E0E0E0` | 12:1 (AAA) | Secondary text, still highly readable |
| Links (phone, email) | `#666666` | `#4A9EFF` | 8:1 (AAA) | Standard link blue, clearly clickable |
| Separators (•) | `#CCCCCC` | `#666666` | 4.5:1 (AA) | Subtle dividers, not primary content |
| Zoho Red (brand) | `#E42527` | `#E42527` | N/A | Unchanged - high contrast on both |

**Design Principle:** High contrast approach for maximum readability across all email clients.

---

### 3. Logo Switching Strategy

Instead of trying to swap `src` attributes (impossible with CSS), we include **both logos** and show/hide based on color scheme:

```html
<!-- Light mode logo (visible by default) -->
<img src="https://tejasgadhia.github.io/signature-generator/assets/zoho-logo-light.png"
     alt="Zoho"
     class="sig-logo-light"
     style="height: 32px; display: block; border: 0;"
     height="32">

<!-- Dark mode logo (hidden by default, shown in dark mode) -->
<img src="https://tejasgadhia.github.io/signature-generator/assets/zoho-logo-dark.png"
     alt="Zoho"
     class="sig-logo-dark"
     style="height: 32px; display: none; border: 0;"
     height="32">
```

**Why both logos?**
- CSS media queries can't change `src` attributes
- `display: none/block` is well-supported in email clients
- Email clients that strip `<style>` tags will only see the light logo (fallback)

**Logo URL Pattern:**
- Base: `https://tejasgadhia.github.io/signature-generator/assets/`
- Light: `zoho-logo-light.png`
- Dark: `zoho-logo-dark.png`

---

### 4. Helper Functions

**New functions in `signature.js`:**

```javascript
/**
 * Generate dark mode CSS style block
 * @returns {string} <style> block with media queries
 */
getDarkModeStyles() {
    return `
<style>
  @media (prefers-color-scheme: dark) {
    .sig-name { color: #FFFFFF !important; }
    .sig-title { color: #E0E0E0 !important; }
    .sig-link { color: #4A9EFF !important; }
    .sig-separator { color: #666666 !important; }
    .sig-logo-light { display: none !important; }
    .sig-logo-dark { display: inline-block !important; }
  }
  .sig-logo-dark { display: none; }
</style>`.trim();
},

/**
 * Get logo URLs for both light and dark modes
 * @returns {Object} {light: string, dark: string}
 */
getLogoUrls() {
    const baseUrl = 'https://tejasgadhia.github.io/signature-generator/assets';
    return {
        light: `${baseUrl}/zoho-logo-light.png`,
        dark: `${baseUrl}/zoho-logo-dark.png`
    };
},

/**
 * Generate dual logo HTML (light + dark versions)
 * @param {string} websiteUrl - URL to wrap logos in
 * @param {number} height - Logo height in pixels
 * @returns {string} HTML with both logo variants
 */
generateDualLogos(websiteUrl, height = 32) {
    const logos = this.getLogoUrls();
    return `
<a href="${websiteUrl}" style="text-decoration: none; display: inline-block;">
    <img src="${logos.light}"
         alt="Zoho"
         class="sig-logo-light"
         style="height: ${height}px; display: block; border: 0;"
         height="${height}">
    <img src="${logos.dark}"
         alt="Zoho"
         class="sig-logo-dark"
         style="height: ${height}px; display: none; border: 0;"
         height="${height}">
</a>`.trim();
}
```

---

### 5. Signature Style Updates

**Changes for each style (Classic, Compact, Modern, Minimal):**

1. **Prepend style block** - Add `this.getDarkModeStyles()` at the top
2. **Add CSS classes** to text elements:
   - Name: `class="sig-name"`
   - Title/Department: `class="sig-title"`
   - Links: `class="sig-link"`
   - Separators: `class="sig-separator"`
3. **Replace single logo** with `this.generateDualLogos(websiteUrl, height)`
4. **Keep inline styles** as fallback (no removal)

**Example transformation (Classic style name field):**

**Before:**
```html
<td style="font-size: 18px; font-weight: bold; color: #333333; padding-bottom: 4px;">
    ${this.escapeHtml(data.name)}
</td>
```

**After:**
```html
<td class="sig-name" style="font-size: 18px; font-weight: bold; color: #333333; padding-bottom: 4px;">
    ${this.escapeHtml(data.name)}
</td>
```

**Rationale:**
- `class="sig-name"` enables dark mode override via media query
- `color: #333333` inline style is fallback for clients that strip `<style>`
- Both coexist without conflict

---

## Asset Acquisition

**Source:** https://www.zoho.com/branding/

**Required logos:**
1. **Light background logo** (current usage)
   - Download from Zoho branding page
   - Save as: `assets/zoho-logo-light.png`
   - Recommended size: 512x512px or similar (will be scaled in signatures)

2. **Dark background logo** (new)
   - Download from Zoho branding page
   - Save as: `assets/zoho-logo-dark.png`
   - Must be white/light colored text
   - Same dimensions as light logo

**Fallback plan:**
- If dark logo not available, create manually by inverting colors
- Ensure it matches Zoho's brand guidelines
- Test visibility on dark backgrounds before deployment

---

## Testing Strategy

### Test Matrix

| Email Client | Platform | Dark Mode Support | Expected Behavior |
|--------------|----------|-------------------|-------------------|
| Gmail | Web | ✅ Full | Style block works, logo swaps, text readable |
| Gmail | Mobile (Android) | ✅ Full | Style block works, logo swaps, text readable |
| Gmail | Mobile (iOS) | ✅ Full | Style block works, logo swaps, text readable |
| Apple Mail | macOS | ✅ Full | Style block works, logo swaps, text readable |
| Apple Mail | iOS | ✅ Full | Style block works, logo swaps, text readable |
| Outlook | Web | ⚠️ Partial | May work, test both modes |
| Outlook | Desktop (Windows) | ❌ None | Fallback to light mode (inline styles) |

### Test Procedure

1. **Generate signature** with all fields populated (Name, Title, Department, Phone, Email, LinkedIn, Twitter, Bookings)
2. **Enable Zoho social links** (test social media section in dark mode)
3. **Copy to clipboard** using the app's copy button
4. **Paste into email client's signature settings**
5. **Send test email to yourself**
6. **View in light mode** - Verify readability and logo visibility
7. **Switch to dark mode** - Verify text contrast and logo swap
8. **Check all 4 signature styles** (Classic, Compact, Modern, Minimal)

### Success Criteria

- ✅ Text passes WCAG AA contrast (4.5:1) in both modes
- ✅ Zoho logo visible on both light and dark backgrounds
- ✅ Links clearly distinguishable from body text
- ✅ Social media icons/links readable in both modes
- ✅ Separators visible but subtle
- ✅ No layout shifts between light/dark mode
- ✅ Outlook Desktop shows readable light mode (fallback)

---

## Email Client Compatibility

### Tier 1: Full Support (80% of users)
- **Gmail** (web + mobile) - Full `@media` query support ✅
- **Apple Mail** (macOS 10.15+ / iOS 13+) - Full `@media` query support ✅

### Tier 2: Partial Support
- **Outlook Web** - May strip some styles, test required ⚠️
- **Yahoo Mail** - Limited dark mode, test required ⚠️

### Tier 3: Fallback Mode
- **Outlook Desktop** - Strips `<style>` tags, uses inline styles ⚠️
- **Thunderbird** - Limited dark mode support ⚠️

**Fallback behavior:** All Tier 3 clients will display light mode signatures (inline styles). This is acceptable since they remain readable.

---

## Implementation Checklist

### Phase 1: Asset Acquisition
- [ ] Visit https://www.zoho.com/branding/
- [ ] Download light background Zoho logo
- [ ] Download dark background Zoho logo (white text version)
- [ ] Save as `assets/zoho-logo-light.png`
- [ ] Save as `assets/zoho-logo-dark.png`
- [ ] Verify both logos are same dimensions
- [ ] Test logos display correctly in browser

### Phase 2: Code Implementation
- [ ] Add `getDarkModeStyles()` function to `signature.js`
- [ ] Add `getLogoUrls()` function to `signature.js`
- [ ] Add `generateDualLogos()` function to `signature.js`
- [ ] Update `generateClassicStyle()` - Add classes, dual logos, style block
- [ ] Update `generateCompactStyle()` - Add classes, dual logos, style block
- [ ] Update `generateModernStyle()` - Add classes, dual logos, style block
- [ ] Update `generateMinimalStyle()` - Add classes, dual logos, style block (no logo in Minimal? Check current implementation)
- [ ] Test all 4 styles generate valid HTML
- [ ] Verify inline styles remain as fallback

### Phase 3: Testing
- [ ] Test in Gmail web (light mode)
- [ ] Test in Gmail web (dark mode)
- [ ] Test in Gmail mobile (light mode)
- [ ] Test in Gmail mobile (dark mode)
- [ ] Test in Apple Mail macOS (light mode)
- [ ] Test in Apple Mail macOS (dark mode)
- [ ] Test in Apple Mail iOS (light mode)
- [ ] Test in Apple Mail iOS (dark mode)
- [ ] Test in Outlook Web (both modes)
- [ ] Test in Outlook Desktop (verify fallback works)

### Phase 4: Documentation & Deployment
- [ ] Update README.md with dark mode feature
- [ ] Update CLAUDE.md with new helper functions
- [ ] Add dark mode testing to testing checklist
- [ ] Commit changes with descriptive message
- [ ] Deploy to GitHub Pages
- [ ] Verify assets load correctly on production

---

## Success Metrics

**v0.6.0 is complete when:**
- ✅ All 4 signature styles support dark mode
- ✅ Text contrast meets WCAG AA in both light and dark modes
- ✅ Zoho logo swaps correctly between light/dark variants
- ✅ Links use appropriate colors (#666 light, #4A9EFF dark)
- ✅ Tested in Gmail and Apple Mail (both modes)
- ✅ Outlook Desktop fallback verified (light mode, readable)
- ✅ Assets deployed to GitHub Pages
- ✅ Documentation updated

---

## Future Considerations

### Potential Enhancements (Post-v0.6.0)
1. **User-controlled dark mode toggle** - Let users preview dark mode in app before copying
2. **Additional color schemes** - Soft contrast option for users who prefer lower brightness
3. **Social media icon colors** - Adapt brand colors for dark backgrounds
4. **Preview pane dark mode** - Sync app preview with signature dark mode

### Known Limitations
1. **Outlook Desktop** - Will never support dark mode due to `<style>` stripping (Microsoft limitation)
2. **Logo file size** - Dual logos increase signature HTML size (~10-20KB depending on logo resolution)
3. **External URLs** - Logos hosted on GitHub Pages require internet connection (acceptable trade-off)

---

## Estimated Effort

**Total:** 2-3 hours

- Asset acquisition: 30 minutes
- Code implementation: 1 hour
- Testing across email clients: 1-1.5 hours
- Documentation: 30 minutes

---

## Appendix: Technical References

### CSS Media Queries in Email
- **Can I Email?** - https://www.caniemail.com/features/css-at-media/
- **Gmail Dark Mode Support** - https://developers.google.com/gmail/design/reference/supported_css
- **Apple Mail Dark Mode** - Supports `prefers-color-scheme` since iOS 13 / macOS 10.15

### WCAG Contrast Requirements
- **WCAG AA:** 4.5:1 for normal text, 3:1 for large text
- **WCAG AAA:** 7:1 for normal text, 4.5:1 for large text
- **Contrast Checker:** https://webaim.org/resources/contrastchecker/

### Zoho Branding
- **Brand Resources:** https://www.zoho.com/branding/
- **Logo Guidelines:** Check for official dark background variants

---

**End of Design Document**
